# 微服务场景

**最后更新**: 2025-11-06 **维护者**: 项目团队

> 📋 **主文档链
> 接**：[30.13.4 微服务场景](../concept-relations-matrix.md#30134-微服务场景)

## 场景描述

微服务架构，需要服务网格、策略治理、可观测性。

## 技术组合

```text
K8s (X=1, 集群编排) + Istio (服务网格) + WasmEdge (Y=4, 沙盒隔离) + OPA (Z=3, 应用策略)
```

## 关系矩阵

| 维度         | 技术选择       | 理由                 |
| ------------ | -------------- | -------------------- |
| **编排**     | K8s            | 企业级编排、高可用   |
| **服务网格** | Istio+WasmEdge | Wasm 插件、流量治理  |
| **策略**     | OPA+Gatekeeper | 策略即代码、实时验证 |

## 实际效果

- **服务间延迟**：<1ms（vs 容器 2-5ms）
- **策略执行**：<1ms（vs OPA 原生 10-50ms）
- **可观测性**：100%覆盖（OTLP+eBPF）

## 三维坐标

- **X 轴（编排）**：X=1（集群编排）
- **Y 轴（隔离）**：Y=4（沙盒隔离）
- **Z 轴（策略）**：Z=3（应用策略）

**坐标表示**：(1, 4, 3) - 集群编排 + 沙盒隔离 + 应用策略

## 技术栈详情

### 编排层

- **Kubernetes 1.30.5**：企业级容器编排
- **高可用**：多 Master 节点，自动故障转移

### 服务网格

- **Istio + WasmEdge**：Wasm 插件支持
- **流量治理**：路由、负载均衡、熔断

### 策略层

- **OPA + Gatekeeper**：策略即代码
- **实时验证**：策略执行延迟 <1ms

### 可观测性

- **OTLP + eBPF**：完整可观测性
- **100% 覆盖**：所有服务都有完整的 Trace 和 Metrics

## 参考文档

- [01. Kubernetes](../../01-kubernetes/kubernetes.md) - Kubernetes 架构与实践
- [19. 服务网格](../../19-service-mesh/service-mesh.md) - 服务网格技术规范
- [06. OPA 策略即代码](../../06-policy-opa/policy-opa.md) - Open Policy Agent

---

**最后更新**：2025-11-06 **维护者**：项目团队
