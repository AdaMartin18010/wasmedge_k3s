# åŒ…å«å…³ç³»å›¾è°±

## ğŸ“‘ ç›®å½•

- [åŒ…å«å…³ç³»å›¾è°±](#åŒ…å«å…³ç³»å›¾è°±)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [åŒ…å«å…³ç³»å®šä¹‰](#åŒ…å«å…³ç³»å®šä¹‰)
  - [åŒ…å«å…³ç³»ç¤ºä¾‹](#åŒ…å«å…³ç³»ç¤ºä¾‹)
    - [è™šæ‹ŸåŒ–å±‚æ¬¡å…³ç³»](#è™šæ‹ŸåŒ–å±‚æ¬¡å…³ç³»)
    - [ç¼–æ’å±‚æ¬¡å…³ç³»](#ç¼–æ’å±‚æ¬¡å…³ç³»)
    - [è¿è¡Œæ—¶å±‚æ¬¡å…³ç³»](#è¿è¡Œæ—¶å±‚æ¬¡å…³ç³»)
    - [ç­–ç•¥å±‚æ¬¡å…³ç³»](#ç­–ç•¥å±‚æ¬¡å…³ç³»)
  - [å…³ç³»ä¼ é€’è§„åˆ™](#å…³ç³»ä¼ é€’è§„åˆ™)
  - [åŒ…å«å…³ç³»åº”ç”¨](#åŒ…å«å…³ç³»åº”ç”¨)
    - [1. æ¶æ„å±‚æ¬¡è®¾è®¡](#1-æ¶æ„å±‚æ¬¡è®¾è®¡)
    - [2. æŠ€æœ¯é€‰å‹å†³ç­–](#2-æŠ€æœ¯é€‰å‹å†³ç­–)
    - [3. ç³»ç»ŸæŠ½è±¡](#3-ç³»ç»ŸæŠ½è±¡)
  - [åŒ…å«å…³ç³»å½¢å¼åŒ–](#åŒ…å«å…³ç³»å½¢å¼åŒ–)
    - [åŒ…å«å…³ç³»å®šä¹‰](#åŒ…å«å…³ç³»å®šä¹‰-1)
    - [åŒ…å«å…³ç³»æ€§è´¨](#åŒ…å«å…³ç³»æ€§è´¨)
  - [å®é™…åº”ç”¨æ¡ˆä¾‹](#å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [æ¡ˆä¾‹ 1ï¼šK3s è¾¹ç¼˜ç¼–æ’](#æ¡ˆä¾‹-1k3s-è¾¹ç¼˜ç¼–æ’)
    - [æ¡ˆä¾‹ 2ï¼šå®¹å™¨è¿è¡Œæ—¶å±‚æ¬¡](#æ¡ˆä¾‹-2å®¹å™¨è¿è¡Œæ—¶å±‚æ¬¡)

---

**æœ€åæ›´æ–°**: 2025-11-06 **ç»´æŠ¤è€…**: é¡¹ç›®å›¢é˜Ÿ

> ğŸ“‹ **ä¸»æ–‡æ¡£é“¾
> æ¥**ï¼š[30.7.1 åŒ…å«å…³ç³»å›¾è°±](../concept-relations-matrix.md#3071-åŒ…å«å…³ç³»å›¾è°±)

## åŒ…å«å…³ç³»å®šä¹‰

**åŒ…å«å…³ç³»ï¼ˆâŠƒï¼‰**ï¼šè¡¨ç¤ºæ¦‚å¿µä¹‹é—´çš„å±‚æ¬¡åŒ…å«å…³ç³»ï¼ŒA âŠƒ B è¡¨ç¤º A åŒ…å« Bã€‚

```mermaid
graph TD
    A[è™šæ‹ŸåŒ–] --> B[å…¨è™šæ‹ŸåŒ–]
    A --> C[åŠè™šæ‹ŸåŒ–]
    B --> D[å®¹å™¨åŒ–]
    C --> D
    D --> E[æ²™ç›’åŒ–]

    F[Kubernetes] --> G[K3s]

    H[å®¹å™¨è¿è¡Œæ—¶] --> I[containerd]
    I --> J[runc]
    I --> K[crun]

    L[ç­–ç•¥å¼•æ“] --> M[Gatekeeper]
    M --> N[OPA]
    N --> O[Rego]

    style A fill:#e1f5ff
    style E fill:#fff4e1
    style F fill:#e8f5e9
    style L fill:#f3e5f5
```

## åŒ…å«å…³ç³»ç¤ºä¾‹

### è™šæ‹ŸåŒ–å±‚æ¬¡å…³ç³»

- **è™šæ‹ŸåŒ– âŠƒ å…¨è™šæ‹ŸåŒ–**
- **è™šæ‹ŸåŒ– âŠƒ åŠè™šæ‹ŸåŒ–**
- **å…¨è™šæ‹ŸåŒ– âŠƒ å®¹å™¨åŒ–**
- **åŠè™šæ‹ŸåŒ– âŠƒ å®¹å™¨åŒ–**
- **å®¹å™¨åŒ– âŠƒ æ²™ç›’åŒ–**

### ç¼–æ’å±‚æ¬¡å…³ç³»

- **Kubernetes âŠƒ K3s**
- **K3s âŠƒ è¾¹ç¼˜ç¼–æ’**
- **K3s âŠƒ WasmEdge æ”¯æŒ**

### è¿è¡Œæ—¶å±‚æ¬¡å…³ç³»

- **å®¹å™¨è¿è¡Œæ—¶ âŠƒ containerd**
- **containerd âŠƒ runc**
- **containerd âŠƒ crun**

### ç­–ç•¥å±‚æ¬¡å…³ç³»

- **ç­–ç•¥å¼•æ“ âŠƒ Gatekeeper**
- **Gatekeeper âŠƒ OPA**
- **OPA âŠƒ Rego**

## å…³ç³»ä¼ é€’è§„åˆ™

**åŒ…å«å…³ç³»ä¼ é€’æ€§**ï¼šå¦‚æœ A âŠƒ B ä¸” B âŠƒ Cï¼Œåˆ™ A âŠƒ C

**ç¤ºä¾‹**ï¼š

- è™šæ‹ŸåŒ– âŠƒ å®¹å™¨åŒ– âŠƒ æ²™ç›’åŒ–
- Kubernetes âŠƒ K3s âŠƒ è¾¹ç¼˜è®¡ç®—

## åŒ…å«å…³ç³»åº”ç”¨

### 1. æ¶æ„å±‚æ¬¡è®¾è®¡

**åº”ç”¨åœºæ™¯**ï¼š

- é€šè¿‡åŒ…å«å…³ç³»å»ºç«‹æ¸…æ™°çš„æ¶æ„å±‚æ¬¡
- åˆ©ç”¨ä¼ é€’æ€§ç®€åŒ–æ¶æ„è®¾è®¡

**ç¤ºä¾‹**ï¼š

- **Kubernetes âŠƒ K3s âŠƒ è¾¹ç¼˜ç¼–æ’**ï¼šè¾¹ç¼˜ç¼–æ’æ˜¯ K3s çš„å­é›†ï¼ŒK3s æ˜¯ Kubernetes çš„å­é›†
- **å®¹å™¨è¿è¡Œæ—¶ âŠƒ containerd âŠƒ crun**ï¼šcrun æ˜¯ containerd çš„å­é›†ï¼Œcontainerd æ˜¯å®¹å™¨è¿è¡Œæ—¶çš„å­é›†

**è®¾è®¡åŸåˆ™**ï¼š

- ä¿æŒå±‚æ¬¡æ¸…æ™°
- åˆ©ç”¨ä¼ é€’æ€§ç®€åŒ–è®¾è®¡

### 2. æŠ€æœ¯é€‰å‹å†³ç­–

**åº”ç”¨åœºæ™¯**ï¼š

- æ ¹æ®åŒ…å«å…³ç³»é€‰æ‹©åˆé€‚çš„æŠ€æœ¯
- ç†è§£æŠ€æœ¯ä¹‹é—´çš„å±‚æ¬¡å…³ç³»

**ç¤ºä¾‹**ï¼š

- å¦‚æœéœ€è¦è¾¹ç¼˜ç¼–æ’èƒ½åŠ›ï¼Œå¯ä»¥é€‰æ‹© K3sï¼ˆKubernetes çš„å­é›†ï¼‰
- å¦‚æœéœ€è¦è½»é‡çº§è¿è¡Œæ—¶ï¼Œå¯ä»¥é€‰æ‹© crunï¼ˆcontainerd çš„å­é›†ï¼‰

**å†³ç­–åŸåˆ™**ï¼š

- é€‰æ‹©æœ€å°æ»¡è¶³éœ€æ±‚çš„å­é›†
- ä¿æŒæŠ€æœ¯æ ˆçš„ä¸€è‡´æ€§

### 3. ç³»ç»ŸæŠ½è±¡

**åº”ç”¨åœºæ™¯**ï¼š

- é€šè¿‡åŒ…å«å…³ç³»å»ºç«‹æŠ½è±¡å±‚æ¬¡
- éšè—åº•å±‚å®ç°ç»†èŠ‚

**ç¤ºä¾‹**ï¼š

- **ç­–ç•¥å¼•æ“ âŠƒ Gatekeeper âŠƒ OPA âŠƒ Rego**ï¼šRego æ˜¯ç­–ç•¥è¯­è¨€ï¼ŒOPA æ˜¯ç­–ç•¥å¼•æ“ï¼ŒGatekeeper æ˜¯ Kubernetes ç­–ç•¥æ§åˆ¶å™¨
- **è™šæ‹ŸåŒ– âŠƒ å®¹å™¨åŒ– âŠƒ æ²™ç›’åŒ–**ï¼šæ²™ç›’åŒ–æ˜¯å®¹å™¨åŒ–çš„å­é›†ï¼Œå®¹å™¨åŒ–æ˜¯è™šæ‹ŸåŒ–çš„å­é›†

**æŠ½è±¡åŸåˆ™**ï¼š

- ä¸Šå±‚æŠ½è±¡ä¸‹å±‚ç»†èŠ‚
- ä¿æŒæ¥å£ä¸€è‡´æ€§

## åŒ…å«å…³ç³»å½¢å¼åŒ–

### åŒ…å«å…³ç³»å®šä¹‰

**æ•°å­¦å®šä¹‰**ï¼š

```text
A âŠƒ B å½“ä¸”ä»…å½“ âˆ€x (x âˆˆ B â†’ x âˆˆ A)
```

**æ€§è´¨**ï¼š

- **è‡ªåæ€§**ï¼šA âŠƒ A
- **ä¼ é€’æ€§**ï¼šå¦‚æœ A âŠƒ B ä¸” B âŠƒ Cï¼Œåˆ™ A âŠƒ C
- **åå¯¹ç§°æ€§**ï¼šå¦‚æœ A âŠƒ B ä¸” B âŠƒ Aï¼Œåˆ™ A = B

### åŒ…å«å…³ç³»æ€§è´¨

**ä¼ é€’æ€§è¯æ˜**ï¼š

- å¦‚æœ A âŠƒ Bï¼Œä¸” B âŠƒ C
- åˆ™ âˆ€x (x âˆˆ C â†’ x âˆˆ B) ä¸” âˆ€x (x âˆˆ B â†’ x âˆˆ A)
- å› æ­¤ âˆ€x (x âˆˆ C â†’ x âˆˆ A)
- å³ A âŠƒ C

**åº”ç”¨**ï¼š

- é€šè¿‡ä¼ é€’æ€§ç®€åŒ–åŒ…å«é“¾
- åˆ©ç”¨ä¼ é€’æ€§è¿›è¡Œæ¨ç†

## å®é™…åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1ï¼šK3s è¾¹ç¼˜ç¼–æ’

**åŒ…å«é“¾**ï¼š

```text
Kubernetes âŠƒ K3s âŠƒ è¾¹ç¼˜ç¼–æ’ âŠƒ WasmEdge æ”¯æŒ
```

**æ¶æ„è®¾è®¡**ï¼š

```yaml
# K3s è¾¹ç¼˜èŠ‚ç‚¹é…ç½®
apiVersion: v1
kind: Node
metadata:
  name: edge-node-1
  labels:
    node-role.kubernetes.io/edge: "true"
spec:
  # K3s è½»é‡çº§é…ç½®
  k3s:
    runtime: containerd
    cni: flannel
    storage: local-path
```

**æ•ˆæœ**ï¼š

- èµ„æºå ç”¨ï¼š<512MB å†…å­˜ï¼ˆç›¸æ¯”å®Œæ•´ Kubernetes å‡å°‘ 80%ï¼‰
- å¯åŠ¨æ—¶é—´ï¼š<30sï¼ˆç›¸æ¯”å®Œæ•´ Kubernetes å‡å°‘ 70%ï¼‰
- è¾¹ç¼˜é€‚é…ï¼šæ”¯æŒç¦»çº¿éƒ¨ç½²å’Œè¾¹ç¼˜è‡ªæ²»

**æŠ€æœ¯æ ˆ**ï¼š

- K3s 1.30.4+k3s2ï¼ˆ2025-11-06 æœ€æ–°ï¼‰
- containerd + crun
- WasmEdge 0.14.1

### æ¡ˆä¾‹ 2ï¼šå®¹å™¨è¿è¡Œæ—¶å±‚æ¬¡

**åŒ…å«é“¾**ï¼š

```text
å®¹å™¨è¿è¡Œæ—¶ âŠƒ containerd âŠƒ crun âŠƒ WasmEdge
```

**é…ç½®ç¤ºä¾‹**ï¼š

```toml
# containerd é…ç½®
version = 2
[plugins."io.containerd.grpc.v1.cri".containerd.runtimes]
  [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
    runtime_type = "io.containerd.runc.v2"
  [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.crun]
    runtime_type = "io.containerd.runc.v2"
    [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.crun.options]
      BinaryName = "crun"
  [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.wasmedge]
    runtime_type = "io.containerd.wasmedge.v1"
```

**æ•ˆæœ**ï¼š

- è¿è¡Œæ—¶é€‰æ‹©ï¼šæ”¯æŒ runcã€crunã€WasmEdge å¤šç§è¿è¡Œæ—¶
- æ€§èƒ½ä¼˜åŒ–ï¼šcrun æ¯” runc å¯åŠ¨å¿« 30%ï¼ŒWasmEdge å†·å¯åŠ¨ <1ms
- èµ„æºå ç”¨ï¼šWasmEdge é•œåƒä½“ç§¯å‡å°‘ 90%

**æ€§èƒ½æŒ‡æ ‡**ï¼š

- runc å¯åŠ¨æ—¶é—´ï¼š~100ms
- crun å¯åŠ¨æ—¶é—´ï¼š~70msï¼ˆå‡å°‘ 30%ï¼‰
- WasmEdge å¯åŠ¨æ—¶é—´ï¼š<1msï¼ˆå‡å°‘ 99%ï¼‰

---

**æœ€åæ›´æ–°**ï¼š2025-11-06 **ç»´æŠ¤è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ
