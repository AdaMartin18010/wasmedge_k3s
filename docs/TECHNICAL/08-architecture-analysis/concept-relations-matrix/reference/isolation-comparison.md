# éš”ç¦»å±‚æ¬¡å…¨é¢å¯¹æ¯”åˆ†æ

## ğŸ“‘ ç›®å½•

- [éš”ç¦»å±‚æ¬¡å…¨é¢å¯¹æ¯”åˆ†æ](#éš”ç¦»å±‚æ¬¡å…¨é¢å¯¹æ¯”åˆ†æ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [30.20.1 éš”ç¦»å±‚æ¬¡æ€ç»´å¯¼å›¾](#30201-éš”ç¦»å±‚æ¬¡æ€ç»´å¯¼å›¾)
  - [30.20.2 å¤šç»´åº¦å¯¹æ¯”çŸ©é˜µ](#30202-å¤šç»´åº¦å¯¹æ¯”çŸ©é˜µ)
    - [æ ¸å¿ƒå±æ€§å¯¹æ¯”çŸ©é˜µ](#æ ¸å¿ƒå±æ€§å¯¹æ¯”çŸ©é˜µ)
    - [æŠ€æœ¯å®ç°å¯¹æ¯”çŸ©é˜µ](#æŠ€æœ¯å®ç°å¯¹æ¯”çŸ©é˜µ)
  - [30.20.3 æŠ€æœ¯é€‰å‹å¯¹æ¯”](#30203-æŠ€æœ¯é€‰å‹å¯¹æ¯”)
    - [æ€§èƒ½ç»´åº¦é€‰å‹](#æ€§èƒ½ç»´åº¦é€‰å‹)
    - [å®‰å…¨ç»´åº¦é€‰å‹](#å®‰å…¨ç»´åº¦é€‰å‹)
    - [æˆæœ¬ç»´åº¦é€‰å‹](#æˆæœ¬ç»´åº¦é€‰å‹)
  - [30.20.4 åº”ç”¨åœºæ™¯å¯¹æ¯”](#30204-åº”ç”¨åœºæ™¯å¯¹æ¯”)
    - [è¾¹ç¼˜è®¡ç®—åœºæ™¯](#è¾¹ç¼˜è®¡ç®—åœºæ™¯)
    - [å¾®æœåŠ¡åœºæ™¯](#å¾®æœåŠ¡åœºæ™¯)
    - [Serverless åœºæ™¯](#serverless-åœºæ™¯)
  - [éš”ç¦»å±‚æ¬¡é€‰å‹åº”ç”¨](#éš”ç¦»å±‚æ¬¡é€‰å‹åº”ç”¨)
    - [1. æŠ€æœ¯é€‰å‹](#1-æŠ€æœ¯é€‰å‹)
    - [2. æ¶æ„è®¾è®¡](#2-æ¶æ„è®¾è®¡)
    - [3. æ€§èƒ½ä¼˜åŒ–](#3-æ€§èƒ½ä¼˜åŒ–)
  - [éš”ç¦»å±‚æ¬¡é€‰å‹ä»£ç ç¤ºä¾‹](#éš”ç¦»å±‚æ¬¡é€‰å‹ä»£ç ç¤ºä¾‹)
    - [éš”ç¦»å±‚æ¬¡é€‰å‹å·¥å…·](#éš”ç¦»å±‚æ¬¡é€‰å‹å·¥å…·)
    - [éš”ç¦»å±‚æ¬¡å¯¹æ¯”åˆ†æ](#éš”ç¦»å±‚æ¬¡å¯¹æ¯”åˆ†æ)
  - [2025 å¹´æœ€æ–°å®è·µ](#2025-å¹´æœ€æ–°å®è·µ)
    - [éš”ç¦»å±‚æ¬¡ä¼˜åŒ–](#éš”ç¦»å±‚æ¬¡ä¼˜åŒ–)
    - [æŠ€æœ¯æ ˆæ¨èï¼ˆ2025ï¼‰](#æŠ€æœ¯æ ˆæ¨è2025)
  - [å®é™…åº”ç”¨æ¡ˆä¾‹](#å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [æ¡ˆä¾‹ 1ï¼šæ··åˆéš”ç¦»å±‚æ¬¡éƒ¨ç½²](#æ¡ˆä¾‹-1æ··åˆéš”ç¦»å±‚æ¬¡éƒ¨ç½²)
    - [æ¡ˆä¾‹ 2ï¼šè¾¹ç¼˜è®¡ç®—éš”ç¦»å±‚æ¬¡é€‰å‹](#æ¡ˆä¾‹-2è¾¹ç¼˜è®¡ç®—éš”ç¦»å±‚æ¬¡é€‰å‹)

---

**æœ€åæ›´æ–°**: 2025-11-07 **ç»´æŠ¤è€…**: é¡¹ç›®å›¢é˜Ÿ

> ğŸ“‹ **ä¸»æ–‡æ¡£é“¾
> æ¥**ï¼š[30.20 éš”ç¦»å±‚æ¬¡å…¨é¢å¯¹æ¯”åˆ†æ](../concept-relations-matrix.md#3020-éš”ç¦»å±‚æ¬¡å…¨é¢å¯¹æ¯”åˆ†æ)

## 30.20.1 éš”ç¦»å±‚æ¬¡æ€ç»´å¯¼å›¾

**å››å±‚éš”ç¦»æ ˆå®Œæ•´æ€ç»´å¯¼å›¾**ï¼š

```mermaid
graph TB
    subgraph "éš”ç¦»å±‚æ¬¡æ€»è§ˆ"
        A[éš”ç¦»å±‚æ¬¡ä½“ç³»]

        A --> L0[L-0 ç¡¬ä»¶è¾…åŠ©å±‚<br/>VT-x/AMD-V/SEV/TPM]
        A --> L1[L-1 å…¨è™šæ‹ŸåŒ–å±‚<br/>KVM/ESXi/Hyper-V/Xen HVM]
        A --> L2[L-2 åŠè™šæ‹ŸåŒ–å±‚<br/>Xen PV/virtio/Hyper-V Enlightenment]
        A --> L3[L-3 å®¹å™¨åŒ–å±‚<br/>runc/containerd/Docker/Podman]
        A --> L4[L-4 æ²™ç›’åŒ–å±‚<br/>gVisor/Firecracker/WASM/Windows Sandbox]
    end

    L0 --> L1
    L1 --> L2
    L2 --> L3
    L3 --> L4

    style L0 fill:#fff9c4
    style L1 fill:#ffccbc
    style L2 fill:#c8e6c9
    style L3 fill:#b3e5fc
    style L4 fill:#e1bee7
```

## 30.20.2 å¤šç»´åº¦å¯¹æ¯”çŸ©é˜µ

### æ ¸å¿ƒå±æ€§å¯¹æ¯”çŸ©é˜µ

| ç»´åº¦           | L-0 ç¡¬ä»¶è¾…åŠ©   | L-1 å…¨è™šæ‹ŸåŒ–   | L-2 åŠè™šæ‹ŸåŒ–   | L-3 å®¹å™¨åŒ–     | L-4 æ²™ç›’åŒ–     |
| -------------- | -------------- | -------------- | -------------- | -------------- | -------------- |
| **éš”ç¦»å¼ºåº¦**   | â­â­â­â­â­ (5) | â­â­â­â­â­ (5) | â­â­â­â­ (4)   | â­â­â­ (3)     | â­â­â­â­â­ (5) |
| **å†·å¯åŠ¨æ—¶é—´** | N/A            | 5-30s          | 3-10s          | 1-5s           | <10ms          |
| **å†…å­˜å¼€é”€**   | N/A            | 128MB+         | 64-128MB       | 10-50MB        | 1-5MB          |
| **CPU å¼€é”€**   | <1%            | 5-10%          | 2-5%           | 1-3%           | <1%            |
| **èµ„æºåˆ©ç”¨ç‡** | N/A            | â­â­ (2)       | â­â­â­ (3)     | â­â­â­â­â­ (5) | â­â­â­â­â­ (5) |
| **éƒ¨ç½²å¯†åº¦**   | N/A            | ä½             | ä¸­             | é«˜             | æé«˜           |
| **ç½‘ç»œæ€§èƒ½**   | N/A            | â­â­â­ (3)     | â­â­â­â­â­ (5) | â­â­â­â­ (4)   | â­â­â­â­â­ (5) |
| **å­˜å‚¨æ€§èƒ½**   | N/A            | â­â­â­ (3)     | â­â­â­â­ (4)   | â­â­â­â­â­ (5) | â­â­â­â­â­ (5) |
| **å…¼å®¹æ€§**     | N/A            | â­â­â­â­â­ (5) | â­â­â­â­ (4)   | â­â­â­â­â­ (5) | â­â­â­ (3)     |
| **å¯ç§»æ¤æ€§**   | N/A            | â­â­â­â­ (4)   | â­â­â­ (3)     | â­â­â­â­â­ (5) | â­â­â­â­â­ (5) |
| **å®‰å…¨åˆè§„**   | â­â­â­â­â­ (5) | â­â­â­â­â­ (5) | â­â­â­â­ (4)   | â­â­â­ (3)     | â­â­â­â­â­ (5) |
| **è¿ç»´å¤æ‚åº¦** | â­â­â­â­ (4)   | â­â­â­ (3)     | â­â­â­ (3)     | â­â­â­â­â­ (5) | â­â­â­â­ (4)   |

### æŠ€æœ¯å®ç°å¯¹æ¯”çŸ©é˜µ

| ç»´åº¦         | L-0 ç¡¬ä»¶è¾…åŠ©   | L-1 å…¨è™šæ‹ŸåŒ– | L-2 åŠè™šæ‹ŸåŒ–  | L-3 å®¹å™¨åŒ–       | L-4 æ²™ç›’åŒ–             |
| ------------ | -------------- | ------------ | ------------- | ---------------- | ---------------------- |
| **æ ¸å¿ƒæŠ€æœ¯** | VT-x/AMD-V/SEV | KVM/QEMU     | virtio/Xen PV | namespace/cgroup | syscall è¿‡æ»¤/å­—èŠ‚ç  VM |
| **éš”ç¦»æœºåˆ¶** | CPU æ¨¡å¼åˆ‡æ¢   | VMCS/EPT     | grant table   | namespace        | seccomp/WASI           |
| **èµ„æºé™åˆ¶** | ç¡¬ä»¶ç‰¹æ€§       | vCPU/vMEM    | å…±äº«å†…å­˜      | cgroup           | èƒ½åŠ›æ¨¡å‹               |
| **ç½‘ç»œå®ç°** | ç¡¬ä»¶ç›´é€š       | vNIC/TAP     | virtio-net    | veth pair        | ç”¨æˆ·æ€ç½‘ç»œæ ˆ           |
| **å­˜å‚¨å®ç°** | ç¡¬ä»¶ç›´é€š       | vmdk/qcow2   | virtio-blk    | overlayfs        | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ           |
| **è°ƒåº¦æœºåˆ¶** | ç¡¬ä»¶è°ƒåº¦       | vCPU è°ƒåº¦    | äº‹ä»¶é€šé“      | cgroup è°ƒåº¦      | ç”¨æˆ·æ€è°ƒåº¦             |

## 30.20.3 æŠ€æœ¯é€‰å‹å¯¹æ¯”

### æ€§èƒ½ç»´åº¦é€‰å‹

| æ€§èƒ½éœ€æ±‚         | æ¨èå±‚çº§     | ç†ç”±             |
| ---------------- | ------------ | ---------------- |
| **æè‡´å¯åŠ¨é€Ÿåº¦** | L-4 æ²™ç›’åŒ–   | <10ms å†·å¯åŠ¨     |
| **é«˜èµ„æºåˆ©ç”¨ç‡** | L-3 å®¹å™¨åŒ–   | é«˜å¯†åº¦éƒ¨ç½²       |
| **é«˜ç½‘ç»œæ€§èƒ½**   | L-2 åŠè™šæ‹ŸåŒ– | è¿‘è£¸æœºç½‘ç»œæ€§èƒ½   |
| **é«˜å­˜å‚¨æ€§èƒ½**   | L-3 å®¹å™¨åŒ–   | ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿ |
| **ä½ CPU å¼€é”€**  | L-4 æ²™ç›’åŒ–   | <1% CPU å¼€é”€     |
| **ä½å†…å­˜å¼€é”€**   | L-4 æ²™ç›’åŒ–   | 1-5MB å†…å­˜å ç”¨   |

### å®‰å…¨ç»´åº¦é€‰å‹

| å®‰å…¨éœ€æ±‚       | æ¨èå±‚çº§     | ç†ç”±                    |
| -------------- | ------------ | ----------------------- |
| **æœ€å¼ºéš”ç¦»**   | L-1/L-4      | å®Œæ•´éš”ç¦»æˆ– syscall è¿‡æ»¤ |
| **åˆè§„è¦æ±‚**   | L-1 å…¨è™šæ‹ŸåŒ– | ç‹¬ç«‹å†…æ ¸ï¼Œå®Œå…¨éš”ç¦»      |
| **é›¶ä¿¡ä»»æ¶æ„** | L-4 æ²™ç›’åŒ–   | èƒ½åŠ›æ¨¡å‹ï¼Œæœ€å°æƒé™      |
| **å¤šç§Ÿæˆ·éš”ç¦»** | L-1 å…¨è™šæ‹ŸåŒ– | å®Œæ•´ VM éš”ç¦»            |
| **ä¾›åº”é“¾å®‰å…¨** | L-4 æ²™ç›’åŒ–   | å­—èŠ‚ç éªŒè¯ï¼Œæ²™ç›’æ‰§è¡Œ    |

### æˆæœ¬ç»´åº¦é€‰å‹

| æˆæœ¬è€ƒè™‘             | æ¨èå±‚çº§   | ç†ç”±                 |
| -------------------- | ---------- | -------------------- |
| **æœ€ä½åŸºç¡€è®¾æ–½æˆæœ¬** | L-3 å®¹å™¨åŒ– | é«˜å¯†åº¦éƒ¨ç½²ï¼Œèµ„æºå…±äº« |
| **æœ€ä½è¿ç»´æˆæœ¬**     | L-3 å®¹å™¨åŒ– | æ ‡å‡†åŒ–ï¼Œæ˜“äºç®¡ç†     |
| **æœ€ä½è¿ç§»æˆæœ¬**     | L-3 å®¹å™¨åŒ– | æ ‡å‡†åŒ–é•œåƒï¼Œæ˜“äºè¿ç§» |
| **æœ€ä¼˜ TCO**         | L-3 å®¹å™¨åŒ– | ç»¼åˆæˆæœ¬æœ€ä¼˜         |

## 30.20.4 åº”ç”¨åœºæ™¯å¯¹æ¯”

### è¾¹ç¼˜è®¡ç®—åœºæ™¯

| å±‚çº§    | é€‚ç”¨æ€§ | å…¸å‹æŠ€æœ¯æ ˆ       | ä¼˜åŠ¿                     |
| ------- | ------ | ---------------- | ------------------------ |
| **L-1** | âŒ     | N/A              | èµ„æºå¼€é”€è¿‡å¤§             |
| **L-2** | âš ï¸     | KVM + virtio     | æ€§èƒ½è¾ƒå¥½ï¼Œä½†èµ„æºå ç”¨ä»é«˜ |
| **L-3** | âœ…âœ…   | K3s + containerd | è½»é‡çº§ï¼Œèµ„æºé«˜æ•ˆ         |
| **L-4** | âœ…âœ…âœ… | K3s + WasmEdge   | æè‡´è½»é‡ï¼Œå¿«é€Ÿå¯åŠ¨       |

**æ¨èæ–¹æ¡ˆ**ï¼šL-4 æ²™ç›’åŒ–ï¼ˆK3s + WasmEdgeï¼‰

### å¾®æœåŠ¡åœºæ™¯

| å±‚çº§    | é€‚ç”¨æ€§ | å…¸å‹æŠ€æœ¯æ ˆ         | ä¼˜åŠ¿                   |
| ------- | ------ | ------------------ | ---------------------- |
| **L-1** | âš ï¸     | K8s + KVM          | éš”ç¦»å¼ºï¼Œä½†å¼€é”€å¤§       |
| **L-2** | âš ï¸     | K8s + KVM + virtio | æ€§èƒ½å¥½ï¼Œä½†å¯†åº¦ä½       |
| **L-3** | âœ…âœ…âœ… | K8s + containerd   | æ ‡å‡†åŒ–ï¼Œé«˜å¯†åº¦ï¼Œæ˜“ç®¡ç† |
| **L-4** | âœ…âœ…   | K8s + WasmEdge     | å¿«é€Ÿå¯åŠ¨ï¼Œèµ„æºé«˜æ•ˆ     |

**æ¨èæ–¹æ¡ˆ**ï¼šL-3 å®¹å™¨åŒ–ï¼ˆK8s + containerdï¼‰æˆ– L-4 æ²™ç›’åŒ–ï¼ˆK8s + WasmEdgeï¼‰

### Serverless åœºæ™¯

| å±‚çº§    | é€‚ç”¨æ€§ | å…¸å‹æŠ€æœ¯æ ˆ           | ä¼˜åŠ¿                   |
| ------- | ------ | -------------------- | ---------------------- |
| **L-1** | âŒ     | N/A                  | å¯åŠ¨å¤ªæ…¢               |
| **L-2** | âŒ     | N/A                  | å¯åŠ¨æ…¢                 |
| **L-3** | âœ…     | Knative + containerd | å¯æ¥å—ï¼Œä½†å¯åŠ¨ä»æœ‰å»¶è¿Ÿ |
| **L-4** | âœ…âœ…âœ… | Knative + WasmEdge   | æè‡´å¿«é€Ÿå¯åŠ¨ï¼Œèµ„æºé«˜æ•ˆ |

**æ¨èæ–¹æ¡ˆ**ï¼šL-4 æ²™ç›’åŒ–ï¼ˆKnative + WasmEdgeï¼‰

## éš”ç¦»å±‚æ¬¡é€‰å‹åº”ç”¨

### 1. æŠ€æœ¯é€‰å‹

**åº”ç”¨åœºæ™¯**ï¼š

- æ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©éš”ç¦»å±‚æ¬¡
- ä¼˜åŒ–æŠ€æœ¯æ ˆé…ç½®

**é€‰å‹æ–¹æ³•**ï¼š

- **æ€§èƒ½éœ€æ±‚**ï¼šæ ¹æ®æ€§èƒ½éœ€æ±‚é€‰æ‹©éš”ç¦»å±‚æ¬¡
- **å®‰å…¨éœ€æ±‚**ï¼šæ ¹æ®å®‰å…¨éœ€æ±‚é€‰æ‹©éš”ç¦»å±‚æ¬¡
- **æˆæœ¬è€ƒè™‘**ï¼šæ ¹æ®æˆæœ¬è€ƒè™‘é€‰æ‹©éš”ç¦»å±‚æ¬¡
- **åœºæ™¯åŒ¹é…**ï¼šæ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©éš”ç¦»å±‚æ¬¡

### 2. æ¶æ„è®¾è®¡

**åº”ç”¨åœºæ™¯**ï¼š

- ä½¿ç”¨éš”ç¦»å±‚æ¬¡è®¾è®¡æ¶æ„
- ä¼˜åŒ–æ¶æ„é…ç½®

**è®¾è®¡æ–¹æ³•**ï¼š

- **å±‚æ¬¡æ˜ å°„**ï¼šå°†éœ€æ±‚æ˜ å°„åˆ°éš”ç¦»å±‚æ¬¡
- **æŠ€æœ¯ç»„åˆ**ï¼šæ ¹æ®å±‚æ¬¡é€‰æ‹©æŠ€æœ¯ç»„åˆ
- **æ¶æ„ä¼˜åŒ–**ï¼šä¼˜åŒ–æ¶æ„é…ç½®

### 3. æ€§èƒ½ä¼˜åŒ–

**åº”ç”¨åœºæ™¯**ï¼š

- é€šè¿‡éš”ç¦»å±‚æ¬¡ä¼˜åŒ–æ€§èƒ½
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ

**ä¼˜åŒ–æ–¹æ³•**ï¼š

- **å±‚æ¬¡åˆ†æ**ï¼šåˆ†æå±‚æ¬¡å¯¹æ€§èƒ½çš„å½±å“
- **æŠ€æœ¯è°ƒæ•´**ï¼šè°ƒæ•´æŠ€æœ¯ç»„åˆä¼˜åŒ–æ€§èƒ½
- **æ€§èƒ½æµ‹è¯•**ï¼šæµ‹è¯•ä¼˜åŒ–æ•ˆæœ

## éš”ç¦»å±‚æ¬¡é€‰å‹ä»£ç ç¤ºä¾‹

### éš”ç¦»å±‚æ¬¡é€‰å‹å·¥å…·

**é€‰å‹å·¥å…·å®ç°**ï¼š

```python
# éš”ç¦»å±‚æ¬¡é€‰å‹å·¥å…·
from dataclasses import dataclass
from typing import List, Dict
from enum import Enum

class IsolationLevel(Enum):
    """éš”ç¦»å±‚æ¬¡"""
    L0_HARDWARE = "L-0ç¡¬ä»¶è¾…åŠ©"
    L1_FULL_VIRT = "L-1å…¨è™šæ‹ŸåŒ–"
    L2_PARA_VIRT = "L-2åŠè™šæ‹ŸåŒ–"
    L3_CONTAINER = "L-3å®¹å™¨åŒ–"
    L4_SANDBOX = "L-4æ²™ç›’åŒ–"

@dataclass
class IsolationRequirement:
    """éš”ç¦»éœ€æ±‚"""
    performance: str  # æ€§èƒ½éœ€æ±‚ï¼šæè‡´å¯åŠ¨é€Ÿåº¦ã€é«˜èµ„æºåˆ©ç”¨ç‡ç­‰
    security: str     # å®‰å…¨éœ€æ±‚ï¼šæœ€å¼ºéš”ç¦»ã€åˆè§„è¦æ±‚ç­‰
    cost: str         # æˆæœ¬è€ƒè™‘ï¼šæœ€ä½åŸºç¡€è®¾æ–½æˆæœ¬ç­‰
    scenario: str     # åº”ç”¨åœºæ™¯ï¼šè¾¹ç¼˜è®¡ç®—ã€å¾®æœåŠ¡ã€Serverlessç­‰

class IsolationSelector:
    """éš”ç¦»å±‚æ¬¡é€‰å‹å™¨"""
    def __init__(self):
        self.performance_map = {
            "æè‡´å¯åŠ¨é€Ÿåº¦": IsolationLevel.L4_SANDBOX,
            "é«˜èµ„æºåˆ©ç”¨ç‡": IsolationLevel.L3_CONTAINER,
            "é«˜ç½‘ç»œæ€§èƒ½": IsolationLevel.L2_PARA_VIRT,
            "é«˜å­˜å‚¨æ€§èƒ½": IsolationLevel.L3_CONTAINER,
            "ä½CPUå¼€é”€": IsolationLevel.L4_SANDBOX,
            "ä½å†…å­˜å¼€é”€": IsolationLevel.L4_SANDBOX,
        }

        self.security_map = {
            "æœ€å¼ºéš”ç¦»": IsolationLevel.L1_FULL_VIRT,
            "åˆè§„è¦æ±‚": IsolationLevel.L1_FULL_VIRT,
            "é›¶ä¿¡ä»»æ¶æ„": IsolationLevel.L4_SANDBOX,
            "å¤šç§Ÿæˆ·éš”ç¦»": IsolationLevel.L1_FULL_VIRT,
            "ä¾›åº”é“¾å®‰å…¨": IsolationLevel.L4_SANDBOX,
        }

        self.scenario_map = {
            "è¾¹ç¼˜è®¡ç®—": IsolationLevel.L4_SANDBOX,
            "å¾®æœåŠ¡": IsolationLevel.L3_CONTAINER,
            "Serverless": IsolationLevel.L4_SANDBOX,
            "AIæ¨ç†": IsolationLevel.L4_SANDBOX,
        }

    def select_level(self, requirement: IsolationRequirement) -> IsolationLevel:
        """é€‰æ‹©éš”ç¦»å±‚æ¬¡"""
        # ä¼˜å…ˆçº§ï¼šåœºæ™¯ > æ€§èƒ½ > å®‰å…¨ > æˆæœ¬
        if requirement.scenario in self.scenario_map:
            return self.scenario_map[requirement.scenario]

        if requirement.performance in self.performance_map:
            return self.performance_map[requirement.performance]

        if requirement.security in self.security_map:
            return self.security_map[requirement.security]

        # é»˜è®¤é€‰æ‹© L-3 å®¹å™¨åŒ–
        return IsolationLevel.L3_CONTAINER

    def get_technology_stack(self, level: IsolationLevel, scenario: str) -> str:
        """è·å–æŠ€æœ¯æ ˆ"""
        stacks = {
            (IsolationLevel.L3_CONTAINER, "è¾¹ç¼˜è®¡ç®—"): "K3s + containerd",
            (IsolationLevel.L4_SANDBOX, "è¾¹ç¼˜è®¡ç®—"): "K3s + WasmEdge",
            (IsolationLevel.L3_CONTAINER, "å¾®æœåŠ¡"): "K8s + containerd",
            (IsolationLevel.L4_SANDBOX, "å¾®æœåŠ¡"): "K8s + WasmEdge",
            (IsolationLevel.L4_SANDBOX, "Serverless"): "Knative + WasmEdge",
        }
        return stacks.get((level, scenario), "æœªæ‰¾åˆ°åŒ¹é…æŠ€æœ¯æ ˆ")

# ä½¿ç”¨ç¤ºä¾‹
selector = IsolationSelector()
requirement = IsolationRequirement(
    performance="æè‡´å¯åŠ¨é€Ÿåº¦",
    security="é›¶ä¿¡ä»»æ¶æ„",
    cost="æœ€ä½åŸºç¡€è®¾æ–½æˆæœ¬",
    scenario="è¾¹ç¼˜è®¡ç®—"
)
level = selector.select_level(requirement)
tech_stack = selector.get_technology_stack(level, requirement.scenario)
print(f"æ¨èéš”ç¦»å±‚æ¬¡: {level.value}")
print(f"æ¨èæŠ€æœ¯æ ˆ: {tech_stack}")
```

### éš”ç¦»å±‚æ¬¡å¯¹æ¯”åˆ†æ

**å¯¹æ¯”åˆ†æå·¥å…·å®ç°**ï¼š

```python
# éš”ç¦»å±‚æ¬¡å¯¹æ¯”åˆ†æå·¥å…·
class IsolationComparator:
    """éš”ç¦»å±‚æ¬¡å¯¹æ¯”å™¨"""
    def __init__(self):
        self.levels = {
            IsolationLevel.L1_FULL_VIRT: {
                "éš”ç¦»å¼ºåº¦": 5,
                "å†·å¯åŠ¨æ—¶é—´": 5,  # 5-30s
                "å†…å­˜å¼€é”€": 128,  # 128MB+
                "CPUå¼€é”€": 7.5,   # 5-10%
                "èµ„æºåˆ©ç”¨ç‡": 2,
                "éƒ¨ç½²å¯†åº¦": 1,
            },
            IsolationLevel.L2_PARA_VIRT: {
                "éš”ç¦»å¼ºåº¦": 4,
                "å†·å¯åŠ¨æ—¶é—´": 6.5,  # 3-10s
                "å†…å­˜å¼€é”€": 96,     # 64-128MB
                "CPUå¼€é”€": 3.5,     # 2-5%
                "èµ„æºåˆ©ç”¨ç‡": 3,
                "éƒ¨ç½²å¯†åº¦": 2,
            },
            IsolationLevel.L3_CONTAINER: {
                "éš”ç¦»å¼ºåº¦": 3,
                "å†·å¯åŠ¨æ—¶é—´": 3,    # 1-5s
                "å†…å­˜å¼€é”€": 30,     # 10-50MB
                "CPUå¼€é”€": 2,       # 1-3%
                "èµ„æºåˆ©ç”¨ç‡": 5,
                "éƒ¨ç½²å¯†åº¦": 4,
            },
            IsolationLevel.L4_SANDBOX: {
                "éš”ç¦»å¼ºåº¦": 5,
                "å†·å¯åŠ¨æ—¶é—´": 0.01,  # <10ms
                "å†…å­˜å¼€é”€": 3,       # 1-5MB
                "CPUå¼€é”€": 0.5,      # <1%
                "èµ„æºåˆ©ç”¨ç‡": 5,
                "éƒ¨ç½²å¯†åº¦": 5,
            },
        }

    def compare_levels(self, level1: IsolationLevel, level2: IsolationLevel) -> Dict:
        """å¯¹æ¯”ä¸¤ä¸ªéš”ç¦»å±‚æ¬¡"""
        metrics1 = self.levels[level1]
        metrics2 = self.levels[level2]

        comparison = {}
        for metric, value1 in metrics1.items():
            value2 = metrics2[metric]
            if value1 < value2:
                comparison[metric] = f"{level1.value} ä¼˜äº {level2.value}"
            elif value1 > value2:
                comparison[metric] = f"{level2.value} ä¼˜äº {level1.value}"
            else:
                comparison[metric] = "ç›¸å½“"

        return comparison

    def find_best_level(self, criteria: Dict[str, float]) -> IsolationLevel:
        """æ ¹æ®æ ‡å‡†æ‰¾åˆ°æœ€ä½³éš”ç¦»å±‚æ¬¡"""
        best_level = None
        best_score = float('inf')

        for level, metrics in self.levels.items():
            score = 0
            for criterion, weight in criteria.items():
                if criterion in metrics:
                    score += metrics[criterion] * weight
            if score < best_score:
                best_score = score
                best_level = level

        return best_level

# ä½¿ç”¨ç¤ºä¾‹
comparator = IsolationComparator()
comparison = comparator.compare_levels(
    IsolationLevel.L3_CONTAINER,
    IsolationLevel.L4_SANDBOX
)
print("éš”ç¦»å±‚æ¬¡å¯¹æ¯”:")
for metric, result in comparison.items():
    print(f"  {metric}: {result}")

criteria = {
    "å†·å¯åŠ¨æ—¶é—´": 0.4,
    "å†…å­˜å¼€é”€": 0.3,
    "éš”ç¦»å¼ºåº¦": 0.3,
}
best = comparator.find_best_level(criteria)
print(f"\næœ€ä½³éš”ç¦»å±‚æ¬¡: {best.value}")
```

## 2025 å¹´æœ€æ–°å®è·µ

### éš”ç¦»å±‚æ¬¡ä¼˜åŒ–

**æŠ€æœ¯æ ˆ**ï¼š

- WasmEdge 0.14.1ï¼ˆL-4 æ²™ç›’åŒ–ï¼‰
- containerd 2.0ï¼ˆL-3 å®¹å™¨åŒ–ï¼‰
- Kubernetes 1.30

**ä¼˜åŒ–ç­–ç•¥**ï¼š

- **æ··åˆéƒ¨ç½²**ï¼šæ ¹æ®åœºæ™¯æ··åˆä½¿ç”¨ä¸åŒéš”ç¦»å±‚æ¬¡
- **æ™ºèƒ½é€‰å‹**ï¼šä½¿ç”¨æ™ºèƒ½é€‰å‹å·¥å…·é€‰æ‹©éš”ç¦»å±‚æ¬¡
- **æ€§èƒ½ä¼˜åŒ–**ï¼šä¼˜åŒ–éš”ç¦»å±‚æ¬¡æ€§èƒ½

### æŠ€æœ¯æ ˆæ¨èï¼ˆ2025ï¼‰

**è¾¹ç¼˜è®¡ç®—**ï¼š

- **é¦–é€‰**ï¼šL-4 æ²™ç›’åŒ–ï¼ˆK3s + WasmEdge 0.14.1ï¼‰
- **æ¬¡é€‰**ï¼šL-3 å®¹å™¨åŒ–ï¼ˆK3s + containerd 2.0ï¼‰

**å¾®æœåŠ¡**ï¼š

- **é¦–é€‰**ï¼šL-3 å®¹å™¨åŒ–ï¼ˆK8s + containerd 2.0ï¼‰
- **æ¬¡é€‰**ï¼šL-4 æ²™ç›’åŒ–ï¼ˆK8s + WasmEdge 0.14.1ï¼‰

**Serverless**ï¼š

- **é¦–é€‰**ï¼šL-4 æ²™ç›’åŒ–ï¼ˆKnative + WasmEdge 0.14.1ï¼‰
- **æ¬¡é€‰**ï¼šL-3 å®¹å™¨åŒ–ï¼ˆKnative + containerd 2.0ï¼‰

## å®é™…åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1ï¼šæ··åˆéš”ç¦»å±‚æ¬¡éƒ¨ç½²

**åœºæ™¯**ï¼šå¤§å‹å¹³å°çš„æ··åˆéš”ç¦»å±‚æ¬¡éƒ¨ç½²

**æŠ€æœ¯æ ˆ**ï¼š

- L-3 å®¹å™¨åŒ–ï¼ˆK8s + containerd 2.0ï¼‰ï¼šä¼ ç»Ÿå¾®æœåŠ¡
- L-4 æ²™ç›’åŒ–ï¼ˆK8s + WasmEdge 0.14.1ï¼‰ï¼šServerless å‡½æ•°

**éƒ¨ç½²ç­–ç•¥**ï¼š

- **å¾®æœåŠ¡**ï¼šä½¿ç”¨ L-3 å®¹å™¨åŒ–ï¼ˆæ ‡å‡†åŒ–ï¼Œç”Ÿæ€ä¸°å¯Œï¼‰
- **Serverless**ï¼šä½¿ç”¨ L-4 æ²™ç›’åŒ–ï¼ˆå¿«é€Ÿå¯åŠ¨ï¼Œä½èµ„æºï¼‰

**æ•ˆæœ**ï¼š

- å¾®æœåŠ¡å¯åŠ¨æ—¶é—´ï¼š1-3s
- Serverless å¯åŠ¨æ—¶é—´ï¼š< 5ms
- èµ„æºåˆ©ç”¨ç‡ï¼š85%
- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.99%

### æ¡ˆä¾‹ 2ï¼šè¾¹ç¼˜è®¡ç®—éš”ç¦»å±‚æ¬¡é€‰å‹

**åœºæ™¯**ï¼š1000+ è¾¹ç¼˜èŠ‚ç‚¹çš„éš”ç¦»å±‚æ¬¡é€‰å‹

**æŠ€æœ¯æ ˆ**ï¼š

- L-4 æ²™ç›’åŒ–ï¼ˆK3s + WasmEdge 0.14.1ï¼‰

**é€‰å‹ç†ç”±**ï¼š

- **å¯åŠ¨æ€§èƒ½**ï¼š< 5ms å†·å¯åŠ¨ï¼Œæ»¡è¶³å®æ—¶å“åº”éœ€æ±‚
- **èµ„æºå ç”¨**ï¼š< 3MB å†…å­˜ï¼Œé€‚åˆèµ„æºå—é™ç¯å¢ƒ
- **éš”ç¦»å¼ºåº¦**ï¼šâ­â­â­â­â­ï¼ˆ5 æ˜Ÿï¼‰ï¼Œæ»¡è¶³å®‰å…¨éœ€æ±‚

**æ•ˆæœ**ï¼š

- å¯åŠ¨æ—¶é—´ï¼š< 5msï¼ˆP99ï¼‰
- å†…å­˜å ç”¨ï¼š< 3MB
- éš”ç¦»å¼ºåº¦ï¼šâ­â­â­â­â­
- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.99%

---

**æœ€åæ›´æ–°**ï¼š2025-11-15 **ç»´æŠ¤è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ
