# A2ï¼šOS èµ„æºå°é—­å…¬ç†

## ðŸ“‘ ç›®å½•

- [A2ï¼šOS èµ„æºå°é—­å…¬ç†](#a2os-èµ„æºå°é—­å…¬ç†)
  - [ðŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æ ¸å¿ƒæ€æƒ³](#11-æ ¸å¿ƒæ€æƒ³)
  - [2 å…¬ç†æè¿°](#2-å…¬ç†æè¿°)
  - [3 å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 ä¸¥æ ¼å½¢å¼åŒ–](#31-ä¸¥æ ¼å½¢å¼åŒ–)
  - [4 å…¬ç†è¯´æ˜Ž](#4-å…¬ç†è¯´æ˜Ž)
    - [4.1 èµ„æºå°é—­çš„å«ä¹‰](#41-èµ„æºå°é—­çš„å«ä¹‰)
    - [4.2 å‘½åç©ºé—´çš„ä½œç”¨](#42-å‘½åç©ºé—´çš„ä½œç”¨)
  - [5 æˆç«‹æ¡ä»¶](#5-æˆç«‹æ¡ä»¶)
    - [5.1 å‡è®¾](#51-å‡è®¾)
    - [5.2 æŠ€æœ¯å‰æ](#52-æŠ€æœ¯å‰æ)
  - [6 ä¾èµ–å…³ç³»](#6-ä¾èµ–å…³ç³»)
    - [6.1 ä¾èµ– A1](#61-ä¾èµ–-a1)
    - [6.2 ä¸Žå…¶ä»–å…¬ç†çš„å…³ç³»](#62-ä¸Žå…¶ä»–å…¬ç†çš„å…³ç³»)
  - [7 éªŒè¯æ–¹æ³•](#7-éªŒè¯æ–¹æ³•)
    - [7.1 ç†è®ºéªŒè¯](#71-ç†è®ºéªŒè¯)
    - [7.2 å®žè¯éªŒè¯](#72-å®žè¯éªŒè¯)
  - [8 åœ¨å„æŠ½è±¡å±‚çš„éªŒè¯](#8-åœ¨å„æŠ½è±¡å±‚çš„éªŒè¯)
    - [8.1 è™šæ‹ŸåŒ–å±‚ï¼ˆÎ¨â‚ï¼‰](#81-è™šæ‹ŸåŒ–å±‚Ïˆ)
    - [8.2 å®¹å™¨åŒ–å±‚ï¼ˆÎ¨â‚‚ï¼‰](#82-å®¹å™¨åŒ–å±‚Ïˆ)
    - [8.3 æ²™ç›’åŒ–å±‚ï¼ˆÎ¨â‚ƒï¼‰](#83-æ²™ç›’åŒ–å±‚Ïˆ)
  - [9 ç›¸å…³æ–‡æ¡£](#9-ç›¸å…³æ–‡æ¡£)
    - [9.1 å½’çº³è¯æ˜Žæ–‡æ¡£](#91-å½’çº³è¯æ˜Žæ–‡æ¡£)
    - [9.2 å…¬ç†å±‚æ–‡æ¡£](#92-å…¬ç†å±‚æ–‡æ¡£)
    - [9.3 æºæ–‡æ¡£](#93-æºæ–‡æ¡£)

---

## 1 æ¦‚è¿°

**A2 OS èµ„æºå°é—­å…¬ç†**å®šä¹‰äº†æ“ä½œç³»ç»Ÿèµ„æºéš”ç¦»çš„åŸºæœ¬æ€§è´¨ï¼Œæ˜¯å½¢å¼åŒ–è®ºè¯çš„åŸºç¡€ä¹‹ä¸€ã€‚

### 1.1 æ ¸å¿ƒæ€æƒ³

> **è¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œå››å¤§å‘½åç©ºé—´å¯å®Œå…¨å°é—­ï¼Œå®žçŽ°èµ„æºçš„å®Œå…¨éš”ç¦»**

---

## 2 å…¬ç†æè¿°

**å…¬ç† A2**ï¼šè¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œå››å¤§å‘½åç©ºé—´å¯å®Œå…¨å°é—­ã€‚è¿™æ„å‘³ç€æ“ä½œç³»ç»Ÿæä¾›
çš„å‘½åç©ºé—´æœºåˆ¶å¯ä»¥å®Œå…¨éš”ç¦»ä¸åŒè¿›ç¨‹ä¹‹é—´çš„èµ„æºè®¿é—®ï¼Œä¿è¯èµ„æºçš„å°é—­æ€§å’Œå®‰å…¨æ€§ã€‚

---

## 3 å½¢å¼åŒ–å®šä¹‰

**å½¢å¼åŒ–**ï¼š`nsâŠ†{pid,mnt,net,ipc,uts,user}`

å…¶ä¸­ï¼š

- **ns**ï¼šå‘½åç©ºé—´é›†åˆ
- **pid**ï¼šè¿›ç¨‹ ID å‘½åç©ºé—´
- **mnt**ï¼šæŒ‚è½½ç‚¹å‘½åç©ºé—´ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰
- **net**ï¼šç½‘ç»œå‘½åç©ºé—´
- **ipc**ï¼šIPC å‘½åç©ºé—´ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰
- **uts**ï¼šUTS å‘½åç©ºé—´ï¼ˆä¸»æœºåï¼‰
- **user**ï¼šç”¨æˆ·å‘½åç©ºé—´

### 3.1 ä¸¥æ ¼å½¢å¼åŒ–

ä½¿ç”¨é›†åˆè®ºï¼š

```text
å®šä¹‰ï¼š
- NS = {pid, mnt, net, ipc, uts, user}ï¼šå‘½åç©ºé—´ç±»åž‹é›†åˆ
- nsáµ¢ âŠ† NSï¼šè¿›ç¨‹ i çš„å‘½åç©ºé—´é›†åˆ
- R = {è¿›ç¨‹, å†…å­˜, æ–‡ä»¶, ç½‘ç»œ}ï¼šèµ„æºç±»åž‹é›†åˆ

å…¬ç†ï¼š
âˆ€r âˆˆ R, âˆƒnsáµ¢ âˆˆ NS : r å¯ä»¥é€šè¿‡ nsáµ¢ å®Œå…¨å°é—­
```

---

## 4 å…¬ç†è¯´æ˜Ž

### 4.1 èµ„æºå°é—­çš„å«ä¹‰

**èµ„æºå°é—­**æ„å‘³ç€ï¼š

1. **éš”ç¦»æ€§**ï¼šä¸åŒè¿›ç¨‹çš„èµ„æºå®Œå…¨éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°
2. **å°é—­æ€§**ï¼šæ¯ä¸ªè¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±çš„èµ„æºï¼Œæ— æ³•è®¿é—®å…¶ä»–è¿›ç¨‹çš„èµ„æº
3. **å®‰å…¨æ€§**ï¼šèµ„æºè®¿é—®å—åˆ°ä¸¥æ ¼æŽ§åˆ¶ï¼Œé˜²æ­¢è¶Šæƒè®¿é—®

### 4.2 å‘½åç©ºé—´çš„ä½œç”¨

**å‘½åç©ºé—´**æ˜¯ Linux å†…æ ¸æä¾›çš„èµ„æºéš”ç¦»æœºåˆ¶ï¼š

1. **pid å‘½åç©ºé—´**ï¼šéš”ç¦»è¿›ç¨‹ IDï¼Œæ¯ä¸ªå‘½åç©ºé—´æœ‰ç‹¬ç«‹çš„è¿›ç¨‹ ID ç©ºé—´
2. **mnt å‘½åç©ºé—´**ï¼šéš”ç¦»æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ï¼Œæ¯ä¸ªå‘½åç©ºé—´æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾
3. **net å‘½åç©ºé—´**ï¼šéš”ç¦»ç½‘ç»œèµ„æºï¼Œæ¯ä¸ªå‘½åç©ºé—´æœ‰ç‹¬ç«‹çš„ç½‘ç»œæŽ¥å£ã€è·¯ç”±è¡¨ç­‰
4. **ipc å‘½åç©ºé—´**ï¼šéš”ç¦»è¿›ç¨‹é—´é€šä¿¡èµ„æºï¼ˆå…±äº«å†…å­˜ã€ä¿¡å·é‡ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰
5. **uts å‘½åç©ºé—´**ï¼šéš”ç¦»ä¸»æœºåå’ŒåŸŸå
6. **user å‘½åç©ºé—´**ï¼šéš”ç¦»ç”¨æˆ· ID å’Œç»„ ID

---

## 5 æˆç«‹æ¡ä»¶

### 5.1 å‡è®¾

- **å‡è®¾**ï¼šæ“ä½œç³»ç»Ÿæ”¯æŒå‘½åç©ºé—´æœºåˆ¶
- **å‰æ**ï¼šLinux å†…æ ¸ â‰¥ 3.8ï¼ˆå‘½åç©ºé—´æ”¯æŒï¼‰

### 5.2 æŠ€æœ¯å‰æ

- **å†…æ ¸æ”¯æŒ**ï¼šLinux å†…æ ¸å¿…é¡»æ”¯æŒå‘½åç©ºé—´æœºåˆ¶
- **å‘½åç©ºé—´ API**ï¼šç³»ç»Ÿè°ƒç”¨å¦‚ `clone()`ã€`unshare()`ã€`setns()` å¯ç”¨
- **cgroup æ”¯æŒ**ï¼šèµ„æºé™åˆ¶éœ€è¦ cgroup æ”¯æŒ

---

## 6 ä¾èµ–å…³ç³»

### 6.1 ä¾èµ– A1

- **åŽŸå› **ï¼šèµ„æºå°é—­éœ€è¦è®¡ç®—ç³»ç»Ÿæ”¯æŒ
- **è¯´æ˜Ž**ï¼šå‘½åç©ºé—´æœºåˆ¶æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢å®žçŽ°çš„ï¼Œéœ€è¦åº•å±‚è®¡ç®—ç³»ç»Ÿæ”¯æŒ

### 6.2 ä¸Žå…¶ä»–å…¬ç†çš„å…³ç³»

- **ä¸Ž A3 çš„å…³ç³»**ï¼šç½‘ç»œå‘½åç©ºé—´ï¼ˆnetï¼‰æ”¯æŒç½‘ç»œå¼‚æ­¥äº¤ä»˜ï¼ˆA3ï¼‰
- **ä¸Ž A4 çš„å…³ç³»**ï¼šèµ„æºå°é—­æ˜¯åˆ†å±‚æŠ½è±¡ï¼ˆA4ï¼‰çš„åŸºç¡€

---

## 7 éªŒè¯æ–¹æ³•

### 7.1 ç†è®ºéªŒè¯

**æ–¹æ³•**ï¼šè¯æ˜Žå‘½åç©ºé—´å¯ä»¥å®Œå…¨éš”ç¦»è¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œèµ„æº

**æ­¥éª¤**ï¼š

1. **å®šä¹‰èµ„æºæ¨¡åž‹**ï¼šå®šä¹‰è¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œèµ„æºçš„æŠ½è±¡æ¨¡åž‹
2. **å®šä¹‰å‘½åç©ºé—´æ˜ å°„**ï¼šå®šä¹‰å‘½åç©ºé—´å¦‚ä½•æ˜ å°„åˆ°èµ„æº
3. **è¯æ˜Žéš”ç¦»æ€§**ï¼šè¯æ˜Žä¸åŒå‘½åç©ºé—´ä¸­çš„èµ„æºå®Œå…¨éš”ç¦»
4. **è¯æ˜Žå°é—­æ€§**ï¼šè¯æ˜Žè¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±å‘½åç©ºé—´ä¸­çš„èµ„æº

### 7.2 å®žè¯éªŒè¯

**æ–¹æ³•**ï¼šä½¿ç”¨å®žé™…ç³»ç»ŸéªŒè¯å‘½åç©ºé—´çš„éš”ç¦»æ•ˆæžœ

**æ¡ˆä¾‹**ï¼š

- **Docker**ï¼šä½¿ç”¨å‘½åç©ºé—´å®žçŽ°å®¹å™¨éš”ç¦»
- **Kubernetes**ï¼šä½¿ç”¨å‘½åç©ºé—´å®žçŽ° Pod éš”ç¦»
- **LXC**ï¼šä½¿ç”¨å‘½åç©ºé—´å®žçŽ°å®¹å™¨éš”ç¦»

---

## 8 åœ¨å„æŠ½è±¡å±‚çš„éªŒè¯

### 8.1 è™šæ‹ŸåŒ–å±‚ï¼ˆÎ¨â‚ï¼‰

**éªŒè¯**ï¼šâœ… **æˆç«‹**

**åŽŸå› **ï¼š

- **VMCS ç¡¬ä»¶æ ¹**ï¼šç¡¬ä»¶çº§åˆ«çš„èµ„æºéš”ç¦»
- **VM éš”ç¦»**ï¼šæ¯ä¸ª VM æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿèµ„æºå‘½åç©ºé—´
- **å®Œå…¨éš”ç¦»**ï¼šVM ä¹‹é—´å®Œå…¨éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°

**å½¢å¼åŒ–**ï¼š

```text
âˆ€vmáµ¢ âˆˆ VM, âˆƒnsáµ¢ âŠ† {pid,mnt,net,ipc,uts,user} :
    nsáµ¢ å®Œå…¨éš”ç¦»ä¸” nsáµ¢ âˆ© nsâ±¼ = âˆ… (i â‰  j)
```

**è¯æ˜Ž**ï¼š

- VMCS ç¡¬ä»¶æ ¹ä¿è¯ VM ä¹‹é—´çš„å®Œå…¨éš”ç¦»
- æ¯ä¸ª VM æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿèµ„æºå‘½åç©ºé—´
- VM æ— æ³•ç›´æŽ¥è®¿é—®å…¶ä»– VM çš„èµ„æº

### 8.2 å®¹å™¨åŒ–å±‚ï¼ˆÎ¨â‚‚ï¼‰

**éªŒè¯**ï¼šâœ… **æˆç«‹**

**åŽŸå› **ï¼š

- **Namespace**ï¼šè¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œå››å¤§å‘½åç©ºé—´å®Œå…¨éš”ç¦»
- **cgroup**ï¼šCPUã€å†…å­˜ã€IO èµ„æºå®Œå…¨éš”ç¦»
- **å®¿ä¸»æœºéš”ç¦»**ï¼šå®¹å™¨æ— æ³•ç›´æŽ¥è®¿é—®å®¿ä¸»æœºèµ„æº

**å½¢å¼åŒ–**ï¼š

```text
âˆ€cáµ¢ âˆˆ Container, âˆƒnsáµ¢ âŠ† {pid,mnt,net,ipc,uts,user} :
    nsáµ¢ å®Œå…¨éš”ç¦»ä¸” nsáµ¢ âˆ© nsâ±¼ = âˆ… (i â‰  j)
```

**è¯æ˜Ž**ï¼š

- Namespace ä¿è¯è¿›ç¨‹ã€å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œèµ„æºçš„å®Œå…¨éš”ç¦»
- cgroup ä¿è¯ CPUã€å†…å­˜ã€IO èµ„æºçš„å®Œå…¨éš”ç¦»
- å®¹å™¨æ— æ³•ç›´æŽ¥è®¿é—®å®¿ä¸»æœºæˆ–å…¶ä»–å®¹å™¨çš„èµ„æº

### 8.3 æ²™ç›’åŒ–å±‚ï¼ˆÎ¨â‚ƒï¼‰

**éªŒè¯**ï¼šâœ… **æˆç«‹**

**åŽŸå› **ï¼š

- **seccomp-bpf**ï¼šç³»ç»Ÿè°ƒç”¨è¿‡æ»¤ï¼Œé™åˆ¶ç³»ç»Ÿè°ƒç”¨
- **capability**ï¼šèƒ½åŠ›é—­åŒ…ï¼Œé™åˆ¶æƒé™
- **ç”¨æˆ·æ€å†…æ ¸**ï¼šå®Œå…¨éš”ç¦»çš„å†…æ ¸çŽ¯å¢ƒ

**å½¢å¼åŒ–**ï¼š

```text
âˆ€sáµ¢ âˆˆ Sandbox, âˆƒcapáµ¢ âŠ† Syscalls :
    capáµ¢ æ˜¯æœ€å°èƒ½åŠ›é—­åŒ…ä¸” capáµ¢ âˆ© capâ±¼ = âˆ… (i â‰  j)
```

**è¯æ˜Ž**ï¼š

- seccomp-bpf ä¿è¯ç³»ç»Ÿè°ƒç”¨çš„å®Œå…¨éš”ç¦»
- capability ä¿è¯æƒé™çš„å®Œå…¨éš”ç¦»
- ç”¨æˆ·æ€å†…æ ¸ä¿è¯å†…æ ¸çŽ¯å¢ƒçš„å®Œå…¨éš”ç¦»

---

## 9 ç›¸å…³æ–‡æ¡£

### 9.1 å½’çº³è¯æ˜Žæ–‡æ¡£

- [`../02-induction-proof/`](../02-induction-proof/) - å½’çº³è¯æ˜Žæ–‡æ¡£é›†
- [`../02-induction-proof/psi1-virtualization.md`](../02-induction-proof/psi1-virtualization.md) -
  ç¬¬ä¸€æ¬¡å½’çº³æ˜ å°„ï¼ˆÎ¨â‚ï¼šè™šæ‹ŸåŒ–å±‚ï¼‰
- [`../02-induction-proof/psi2-containerization.md`](../02-induction-proof/psi2-containerization.md) -
  ç¬¬äºŒæ¬¡å½’çº³æ˜ å°„ï¼ˆÎ¨â‚‚ï¼šå®¹å™¨åŒ–å±‚ï¼‰
- [`../02-induction-proof/psi3-sandboxing.md`](../02-induction-proof/psi3-sandboxing.md) -
  ç¬¬ä¸‰æ¬¡å½’çº³æ˜ å°„ï¼ˆÎ¨â‚ƒï¼šæ²™ç›’åŒ–å±‚ï¼‰

### 9.2 å…¬ç†å±‚æ–‡æ¡£

- [`README.md`](README.md) - å…¬ç†å±‚æ€»è§ˆ
- [`A1-von-neumann.md`](A1-von-neumann.md) - A1ï¼šå†¯Â·è¯ºä¾æ›¼ç­‰ä»·
- [`A3-network-async.md`](A3-network-async.md) - A3ï¼šç½‘ç»œå¼‚æ­¥äº¤ä»˜
- [`A4-layer-abstraction.md`](A4-layer-abstraction.md) - A4ï¼šåˆ†å±‚å¯æŠ½è±¡

### 9.3 æºæ–‡æ¡£

- [`../../architecture_view.md`](../../architecture_view.md) - æž¶æž„è§†è§’çš„æ ¸å¿ƒè®º
  è¿°

---

**æœ€åŽæ›´æ–°**ï¼š2025-11-07
**æ–‡æ¡£çŠ¶æ€**ï¼šâœ… å®Œæ•´ | ðŸ“Š åŒ…å« 2025 å¹´æœ€æ–°è¶‹åŠ¿ | ðŸŽ¯ ç†è®ºä½“ç³»å®Œæ•´
**ç‰ˆæœ¬**ï¼šv1.0
**å‚è€ƒ**ï¼š`architecture_view.md` å…¬ç†å±‚éƒ¨åˆ†
**ç»´æŠ¤è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ

> **ðŸ“Š 2025 å¹´æŠ€æœ¯è¶‹åŠ¿å‚è€ƒ**ï¼šè¯¦ç»†æŠ€æœ¯çŠ¶æ€å’Œç‰ˆæœ¬ä¿¡æ¯è¯·æŸ¥çœ‹
> [27. 2025 å¹´æŠ€æœ¯è¶‹åŠ¿æ±‡æ€»](../../../../TECHNICAL/10-reference-trends/2025-trends/2025-trends.md)
