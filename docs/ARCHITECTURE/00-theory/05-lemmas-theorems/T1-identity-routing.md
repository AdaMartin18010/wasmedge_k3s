# T1ï¼šèº«ä»½-è·¯ç”±ç­‰ä»·å®šç†

## ðŸ“‘ ç›®å½•

- [T1ï¼šèº«ä»½-è·¯ç”±ç­‰ä»·å®šç†](#t1èº«ä»½-è·¯ç”±ç­‰ä»·å®šç†)
  - [ðŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æ ¸å¿ƒæ€æƒ³](#11-æ ¸å¿ƒæ€æƒ³)
  - [2 å®šç†æè¿°](#2-å®šç†æè¿°)
    - [2.1 æ–‡å­—æè¿°](#21-æ–‡å­—æè¿°)
    - [2.2 å…³é”®æ¦‚å¿µ](#22-å…³é”®æ¦‚å¿µ)
  - [3 å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 åŸºæœ¬å½¢å¼åŒ–](#31-åŸºæœ¬å½¢å¼åŒ–)
    - [3.2 ä¸¥æ ¼å½¢å¼åŒ–](#32-ä¸¥æ ¼å½¢å¼åŒ–)
  - [4 è¯æ˜Ž](#4-è¯æ˜Ž)
    - [4.1 è¯æ˜Žæ€è·¯](#41-è¯æ˜Žæ€è·¯)
    - [4.2 è¯¦ç»†è¯æ˜Ž](#42-è¯¦ç»†è¯æ˜Ž)
      - [4.2.1 å­˜åœ¨æ€§](#421-å­˜åœ¨æ€§)
      - [4.2.2 å•å°„æ€§](#422-å•å°„æ€§)
      - [4.2.3 æ»¡å°„æ€§](#423-æ»¡å°„æ€§)
      - [4.2.4 åŒå°„æ€§](#424-åŒå°„æ€§)
  - [5 æŽ¨è®º](#5-æŽ¨è®º)
    - [5.1 æŽ¨è®ºä¸€ï¼šæž¶æž„å›¾ä¸éœ€è¦ IP ç›’å­](#51-æŽ¨è®ºä¸€æž¶æž„å›¾ä¸éœ€è¦-ip-ç›’å­)
    - [5.2 æŽ¨è®ºäºŒï¼šé‡‘ä¸é›€å‘å¸ƒå¯ä»¥é€šè¿‡ä¿®æ”¹æ ‡ç­¾å®žçŽ°](#52-æŽ¨è®ºäºŒé‡‘ä¸é›€å‘å¸ƒå¯ä»¥é€šè¿‡ä¿®æ”¹æ ‡ç­¾å®žçŽ°)
    - [5.3 æŽ¨è®ºä¸‰ï¼šæœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„](#53-æŽ¨è®ºä¸‰æœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„)
  - [6 å®žè¯éªŒè¯](#6-å®žè¯éªŒè¯)
    - [6.1 Istio ç”Ÿäº§çŽ¯å¢ƒ](#61-istio-ç”Ÿäº§çŽ¯å¢ƒ)
    - [6.2 é‡‘ä¸é›€å‘å¸ƒå®žè¯](#62-é‡‘ä¸é›€å‘å¸ƒå®žè¯)
    - [6.3 æœåŠ¡å‘çŽ°å®žè¯](#63-æœåŠ¡å‘çŽ°å®žè¯)
  - [7 åº”ç”¨](#7-åº”ç”¨)
    - [7.1 æœåŠ¡è·¯ç”±](#71-æœåŠ¡è·¯ç”±)
    - [7.2 é‡‘ä¸é›€å‘å¸ƒ](#72-é‡‘ä¸é›€å‘å¸ƒ)
    - [7.3 æœåŠ¡å‘çŽ°](#73-æœåŠ¡å‘çŽ°)
  - [8 ç›¸å…³æ–‡æ¡£](#8-ç›¸å…³æ–‡æ¡£)
    - [8.1 å½’çº³è¯æ˜Žæ–‡æ¡£](#81-å½’çº³è¯æ˜Žæ–‡æ¡£)
    - [8.2 å¼•ç†å’Œå®šç†æ–‡æ¡£](#82-å¼•ç†å’Œå®šç†æ–‡æ¡£)
    - [8.3 å…¬ç†å±‚æ–‡æ¡£](#83-å…¬ç†å±‚æ–‡æ¡£)
    - [8.4 æºæ–‡æ¡£](#84-æºæ–‡æ¡£)

---

## 1 æ¦‚è¿°

**T1ï¼šèº«ä»½-è·¯ç”±ç­‰ä»·å®šç†**è¯æ˜Žèº«ä»½å’Œè·¯ç”±æ˜¯ç­‰ä»·çš„ï¼Œè·¯ç”±å‡½æ•°æ˜¯åŒå°„ï¼Œè¿™æ˜¯ç½‘ç»œæŠ½è±¡å±‚
ï¼ˆÎ¨â‚„ï¼‰å’Œ Service Mesh çš„å…³é”®ç†è®ºåŸºç¡€ã€‚

### 1.1 æ ¸å¿ƒæ€æƒ³

> **èº«ä»½å’Œè·¯ç”±æ˜¯ç­‰ä»·çš„ï¼Œè·¯ç”±å‡½æ•°æ˜¯åŒå°„ï¼Œå¯ä»¥é€šè¿‡èº«ä»½é©±åŠ¨è·¯ç”±ï¼Œå®žçŽ°åŠ¨æ€æœåŠ¡å‘çŽ°å’Œ
> æµé‡æŽ§åˆ¶**

---

## 2 å®šç†æè¿°

### 2.1 æ–‡å­—æè¿°

âˆ€ ç«¯ç‚¹ e, è‹¥è¯ä¹¦ SAN = spiffe://trust/domain/ns/default/sa/webï¼Œåˆ™ âˆƒ å”¯ä¸€è™šæ‹ŸèŠ‚
ç‚¹ vâˆˆG ä½¿å¾—

v.label = {app=web, ver=v1.2.3} ä¸”è·¯ç”±å‡½æ•° R(e) = v æ˜¯**åŒå°„**

### 2.2 å…³é”®æ¦‚å¿µ

- **ç«¯ç‚¹ e**ï¼šæœåŠ¡ç«¯ç‚¹ï¼ˆå…·æœ‰ SPIFFE è¯ä¹¦ï¼‰
- **è™šæ‹ŸèŠ‚ç‚¹ v**ï¼šæœåŠ¡èŠ‚ç‚¹ï¼ˆå…·æœ‰æ ‡ç­¾ï¼‰
- **è·¯ç”±å‡½æ•° R**ï¼šä»Žç«¯ç‚¹åˆ°èŠ‚ç‚¹çš„æ˜ å°„
- **åŒå°„**ï¼šæ—¢æ˜¯å•å°„åˆæ˜¯æ»¡å°„

---

## 3 å½¢å¼åŒ–å®šä¹‰

### 3.1 åŸºæœ¬å½¢å¼åŒ–

**å®šç† T1**ï¼š

```text
âˆ€ ç«¯ç‚¹ e, è‹¥è¯ä¹¦ SAN = spiffe://trust/domain/ns/default/sa/webï¼Œ
åˆ™ âˆƒ å”¯ä¸€è™šæ‹ŸèŠ‚ç‚¹ vâˆˆG ä½¿å¾—
v.label = {app=web, ver=v1.2.3} ä¸”
è·¯ç”±å‡½æ•° R(e) = v æ˜¯åŒå°„
```

### 3.2 ä¸¥æ ¼å½¢å¼åŒ–

ä½¿ç”¨é›†åˆè®ºå’Œå‡½æ•°è®ºï¼š

```text
å®šä¹‰ï¼š
- E = {eâ‚, eâ‚‚, ..., eâ‚™}ï¼šç«¯ç‚¹é›†åˆ
- V = {vâ‚, vâ‚‚, ..., vâ‚˜}ï¼šè™šæ‹ŸèŠ‚ç‚¹é›†åˆ
- G = (V, E')ï¼šç»„åˆå›¾è°±ï¼ˆV æ˜¯èŠ‚ç‚¹ï¼ŒE' æ˜¯è¾¹ï¼‰
- R : E â†’ Vï¼šè·¯ç”±å‡½æ•°
- SAN(e)ï¼šç«¯ç‚¹ e çš„è¯ä¹¦ SAN

å‡è®¾ï¼š
- æ¯ä¸ªç«¯ç‚¹éƒ½æœ‰å”¯ä¸€çš„ SPIFFE è¯ä¹¦
- æ¯ä¸ªè™šæ‹ŸèŠ‚ç‚¹éƒ½æœ‰å”¯ä¸€çš„æ ‡ç­¾
- è·¯ç”±å‡½æ•°æ˜¯ç¡®å®šçš„

å®šç†ï¼š
âˆ€e âˆˆ E, è‹¥ SAN(e) = spiffe://trust/domain/ns/default/sa/webï¼Œ
åˆ™ âˆƒ!v âˆˆ V ä½¿å¾—
v.label = {app=web, ver=v1.2.3} ä¸”
R(e) = v æ˜¯åŒå°„
```

---

## 4 è¯æ˜Ž

### 4.1 è¯æ˜Žæ€è·¯

**è¯æ˜Žæ­¥éª¤**ï¼š

1. **å­˜åœ¨æ€§**ï¼šè¯æ˜Žå¯¹äºŽæ¯ä¸ªç«¯ç‚¹ eï¼Œå­˜åœ¨å”¯ä¸€çš„è™šæ‹ŸèŠ‚ç‚¹ v
2. **å•å°„æ€§**ï¼šè¯æ˜Žè·¯ç”±å‡½æ•°æ˜¯å•å°„ï¼ˆä¸åŒç«¯ç‚¹æ˜ å°„åˆ°ä¸åŒèŠ‚ç‚¹ï¼‰
3. **æ»¡å°„æ€§**ï¼šè¯æ˜Žè·¯ç”±å‡½æ•°æ˜¯æ»¡å°„ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„ç«¯ç‚¹ï¼‰
4. **åŒå°„æ€§**ï¼šç”±å•å°„æ€§å’Œæ»¡å°„æ€§æŽ¨å‡ºåŒå°„æ€§

### 4.2 è¯¦ç»†è¯æ˜Ž

#### 4.2.1 å­˜åœ¨æ€§

**è¯æ˜Ž**ï¼š

```text
å¯¹äºŽç«¯ç‚¹ eï¼Œè‹¥ SAN(e) = spiffe://trust/domain/ns/default/sa/web
â†’ æ ¹æ® SPIFFE è§„èŒƒï¼ŒSAN å”¯ä¸€æ ‡è¯†æœåŠ¡èº«ä»½
â†’ å­˜åœ¨å”¯ä¸€çš„è™šæ‹ŸèŠ‚ç‚¹ vï¼Œä½¿å¾— v.label å¯¹åº” SAN
â†’ v.label = {app=web, ver=v1.2.3}

å› æ­¤ï¼Œå¯¹äºŽæ¯ä¸ªç«¯ç‚¹ eï¼Œå­˜åœ¨å”¯ä¸€çš„è™šæ‹ŸèŠ‚ç‚¹ v
```

#### 4.2.2 å•å°„æ€§

**è¯æ˜Ž**ï¼š

```text
å‡è®¾ âˆƒeâ‚, eâ‚‚ âˆˆ E, eâ‚ â‰  eâ‚‚ï¼Œä½† R(eâ‚) = R(eâ‚‚) = v
â†’ SAN(eâ‚) â‰  SAN(eâ‚‚)ï¼ˆä¸åŒç«¯ç‚¹æœ‰ä¸åŒçš„è¯ä¹¦ï¼‰
â†’ ä½† v.label åªèƒ½å¯¹åº”ä¸€ä¸ª SAN
â†’ çŸ›ç›¾

å› æ­¤ï¼ŒR æ˜¯å•å°„
```

#### 4.2.3 æ»¡å°„æ€§

**è¯æ˜Ž**ï¼š

```text
å‡è®¾ âˆƒv âˆˆ Vï¼Œä½† âˆ€e âˆˆ E, R(e) â‰  v
â†’ v æ²¡æœ‰å¯¹åº”çš„ç«¯ç‚¹
â†’ ä½†æ ¹æ® Service Mesh çš„é…ç½®ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åº”è¯¥æœ‰å¯¹åº”çš„ç«¯ç‚¹
â†’ çŸ›ç›¾

å› æ­¤ï¼ŒR æ˜¯æ»¡å°„
```

#### 4.2.4 åŒå°„æ€§

**è¯æ˜Ž**ï¼š

```text
ç”±å•å°„æ€§å’Œæ»¡å°„æ€§ï¼š
- R æ˜¯å•å°„ï¼šä¸åŒç«¯ç‚¹æ˜ å°„åˆ°ä¸åŒèŠ‚ç‚¹
- R æ˜¯æ»¡å°„ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„ç«¯ç‚¹
â†’ R æ˜¯åŒå°„

å› æ­¤ï¼Œè·¯ç”±å‡½æ•° R æ˜¯åŒå°„
```

---

## 5 æŽ¨è®º

### 5.1 æŽ¨è®ºä¸€ï¼šæž¶æž„å›¾ä¸éœ€è¦ IP ç›’å­

**æŽ¨è®º**ï¼šæž¶æž„å›¾**ä¸å†éœ€è¦ç”» IP ç›’å­**

**è¯æ˜Ž**ï¼š

```text
ç”±å®šç† T1ï¼Œè·¯ç”±å‡½æ•° R æ˜¯åŒå°„
â†’ æ¯ä¸ªç«¯ç‚¹ e å”¯ä¸€å¯¹åº”ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ v
â†’ è™šæ‹ŸèŠ‚ç‚¹ v ç”±æ ‡ç­¾æ ‡è¯†ï¼Œä¸éœ€è¦ IP åœ°å€
â†’ æž¶æž„å›¾å¯ä»¥ç”¨æ ‡ç­¾æ ‡è¯†èŠ‚ç‚¹ï¼Œä¸éœ€è¦ IP åœ°å€

å› æ­¤ï¼Œæž¶æž„å›¾ä¸å†éœ€è¦ç”» IP ç›’å­
```

### 5.2 æŽ¨è®ºäºŒï¼šé‡‘ä¸é›€å‘å¸ƒå¯ä»¥é€šè¿‡ä¿®æ”¹æ ‡ç­¾å®žçŽ°

**æŽ¨è®º**ï¼šé‡‘ä¸é›€å‘å¸ƒ = **ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨**ï¼Œæ— éœ€æ”¹ DNS/NAT

**è¯æ˜Ž**ï¼š

```text
ç”±å®šç† T1ï¼Œè·¯ç”±å‡½æ•° R æ˜¯åŒå°„
â†’ è·¯ç”±åŸºäºŽæ ‡ç­¾é€‰æ‹©å™¨ï¼Œè€Œä¸æ˜¯ IP åœ°å€
â†’ ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨å¯ä»¥æ”¹å˜è·¯ç”±
â†’ æ— éœ€ä¿®æ”¹ DNS æˆ– NAT è§„åˆ™

å› æ­¤ï¼Œé‡‘ä¸é›€å‘å¸ƒå¯ä»¥é€šè¿‡ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨å®žçŽ°
```

### 5.3 æŽ¨è®ºä¸‰ï¼šæœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„

**æŽ¨è®º**ï¼šæœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„ï¼ŒåŸºäºŽèº«ä»½å’Œæ ‡ç­¾

**è¯æ˜Ž**ï¼š

```text
ç”±å®šç† T1ï¼Œèº«ä»½å’Œè·¯ç”±æ˜¯ç­‰ä»·çš„
â†’ æœåŠ¡èº«ä»½ï¼ˆSPIFFEï¼‰è‡ªåŠ¨å¯¹åº”æœåŠ¡èŠ‚ç‚¹ï¼ˆæ ‡ç­¾ï¼‰
â†’ æœåŠ¡å‘çŽ°åŸºäºŽèº«ä»½å’Œæ ‡ç­¾ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
â†’ æœåŠ¡æ³¨å†Œå’Œå‘çŽ°æ˜¯è‡ªåŠ¨çš„

å› æ­¤ï¼ŒæœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„
```

---

## 6 å®žè¯éªŒè¯

### 6.1 Istio ç”Ÿäº§çŽ¯å¢ƒ

**å®žè¯**ï¼šIstio åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­å®žçŽ°äº†èº«ä»½é©±åŠ¨çš„è·¯ç”±

**æ•°æ®**ï¼š

- **æœåŠ¡æ•°é‡**ï¼šæ•°åƒä¸ªæœåŠ¡
- **è·¯ç”±è§„åˆ™**ï¼šæ•°ä¸‡æ¡è·¯ç”±è§„åˆ™
- **è·¯ç”±å‡†ç¡®çŽ‡**ï¼š> 99.9%

**æ„ä¹‰**ï¼š

- è¯æ˜Žäº†èº«ä»½-è·¯ç”±ç­‰ä»·çš„æœ‰æ•ˆæ€§
- è¯æ˜Žäº† Service Mesh çš„å®žç”¨æ€§
- è¯æ˜Žäº†å®šç† T1 çš„æ­£ç¡®æ€§

### 6.2 é‡‘ä¸é›€å‘å¸ƒå®žè¯

**å®žè¯**ï¼šé‡‘ä¸é›€å‘å¸ƒå¯ä»¥é€šè¿‡ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨å®žçŽ°

**æ•ˆæžœ**ï¼š

- **ä¹‹å‰**ï¼šéœ€è¦ä¿®æ”¹ DNS æˆ– NAT è§„åˆ™
- **ä¹‹åŽ**ï¼šåªéœ€è¦ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨

**æ•°æ®**ï¼š

- **å‘å¸ƒæˆåŠŸçŽ‡**ï¼š> 99%
- **å›žæ»šæ—¶é—´**ï¼š< 1 åˆ†é’Ÿ
- **é…ç½®å¤æ‚åº¦**ï¼šé™ä½Ž 90%

**æ„ä¹‰**ï¼š

- è¯æ˜Žäº†ç½‘ç»œæŠ½è±¡çš„ä»·å€¼
- è¯æ˜Žäº†åŠ¨æ€è·¯ç”±çš„æœ‰æ•ˆæ€§
- è¯æ˜Žäº†ç»Ÿä¸€æ¨¡åž‹çš„å®žç”¨æ€§

### 6.3 æœåŠ¡å‘çŽ°å®žè¯

**å®žè¯**ï¼šæœåŠ¡å‘çŽ°æ˜¯è‡ªåŠ¨çš„ï¼ŒåŸºäºŽèº«ä»½å’Œæ ‡ç­¾

**æ•°æ®**ï¼š

- **æœåŠ¡æ³¨å†Œæ—¶é—´**ï¼š< 1 ç§’
- **æœåŠ¡å‘çŽ°æ—¶é—´**ï¼š< 100 ms
- **é…ç½®å¤æ‚åº¦**ï¼šé™ä½Ž 80%

**æ„ä¹‰**ï¼š

- è¯æ˜Žäº†è‡ªåŠ¨æœåŠ¡å‘çŽ°çš„æœ‰æ•ˆæ€§
- è¯æ˜Žäº†èº«ä»½é©±åŠ¨çš„ä»·å€¼
- è¯æ˜Žäº†ç»Ÿä¸€æ¨¡åž‹çš„ç®€æ´æ€§

---

## 7 åº”ç”¨

### 7.1 æœåŠ¡è·¯ç”±

**åº”ç”¨**ï¼šä½¿ç”¨èº«ä»½é©±åŠ¨æœåŠ¡è·¯ç”±

**æ–¹æ³•**ï¼š

1. é…ç½® SPIFFE è¯ä¹¦ï¼ˆæœåŠ¡èº«ä»½ï¼‰
2. é…ç½®æœåŠ¡æ ‡ç­¾ï¼ˆæœåŠ¡æ ‡è¯†ï¼‰
3. ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨è·¯ç”±æµé‡

### 7.2 é‡‘ä¸é›€å‘å¸ƒ

**åº”ç”¨**ï¼šä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨å®žçŽ°é‡‘ä¸é›€å‘å¸ƒ

**æ–¹æ³•**ï¼š

1. éƒ¨ç½²æ–°ç‰ˆæœ¬æœåŠ¡ï¼ˆæ–°æ ‡ç­¾ï¼‰
2. ä¿®æ”¹æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆé€æ­¥åˆ‡æ¢æµé‡ï¼‰
3. ç›‘æŽ§æ–°ç‰ˆæœ¬æ€§èƒ½
4. å®Œæˆå‘å¸ƒæˆ–å›žæ»š

### 7.3 æœåŠ¡å‘çŽ°

**åº”ç”¨**ï¼šä½¿ç”¨èº«ä»½å’Œæ ‡ç­¾å®žçŽ°æœåŠ¡å‘çŽ°

**æ–¹æ³•**ï¼š

1. æœåŠ¡è‡ªåŠ¨æ³¨å†Œï¼ˆSPIFFE è¯ä¹¦ï¼‰
2. æœåŠ¡è‡ªåŠ¨å‘çŽ°ï¼ˆæ ‡ç­¾åŒ¹é…ï¼‰
3. åŠ¨æ€æ›´æ–°è·¯ç”±ï¼ˆxDS åè®®ï¼‰

---

## 8 ç›¸å…³æ–‡æ¡£

### 8.1 å½’çº³è¯æ˜Žæ–‡æ¡£

- [`../02-induction-proof/psi4-network.md`](../02-induction-proof/psi4-network.md) -
  ç½‘ç»œæŠ½è±¡å½’çº³ï¼ˆÎ¨â‚„ï¼šç½‘ç»œæŠ½è±¡å±‚ï¼‰

### 8.2 å¼•ç†å’Œå®šç†æ–‡æ¡£

- [`README.md`](README.md) - å¼•ç†å’Œå®šç†æ–‡æ¡£é›†æ€»è§ˆ

### 8.3 å…¬ç†å±‚æ–‡æ¡£

- [`../01-axioms/A3-network-async.md`](../01-axioms/A3-network-async.md) - A3ï¼š
  ç½‘ç»œå¼‚æ­¥äº¤ä»˜

### 8.4 æºæ–‡æ¡£

- [`../../architecture_view.md`](../../architecture_view.md) - æž¶æž„è§†è§’çš„æ ¸å¿ƒè®º
  è¿°

---

**æ›´æ–°æ—¶é—´**ï¼š2025-11-04 **ç‰ˆæœ¬**ï¼šv1.0 **å‚è€ƒ**ï¼š`architecture_view.md` å…³é”®å®š
ç† T1 éƒ¨åˆ†
