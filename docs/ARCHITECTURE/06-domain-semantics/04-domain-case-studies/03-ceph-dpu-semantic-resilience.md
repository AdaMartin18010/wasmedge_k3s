# Ceph/DPU æ¶æ„ä¸­çš„åˆ†å±‚æ¶ˆè§£å¾‹ï¼šç¡¬ä»¶å¸è½½ä¸‹çš„é¢†åŸŸè¯­ä¹‰åšå®ˆ

**ç‰ˆæœ¬**ï¼šv1.0 **åˆ›å»ºæ—¥æœŸ**ï¼š2025-11-08 **ç»´æŠ¤è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ

## ğŸ“‘ ç›®å½•

- [Ceph/DPU æ¶æ„ä¸­çš„åˆ†å±‚æ¶ˆè§£å¾‹ï¼šç¡¬ä»¶å¸è½½ä¸‹çš„é¢†åŸŸè¯­ä¹‰åšå®ˆ](#cephdpu-æ¶æ„ä¸­çš„åˆ†å±‚æ¶ˆè§£å¾‹ç¡¬ä»¶å¸è½½ä¸‹çš„é¢†åŸŸè¯­ä¹‰åšå®ˆ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æ ¸å¿ƒæ€æƒ³](#11-æ ¸å¿ƒæ€æƒ³)
    - [1.2 æ–‡æ¡£å®šä½](#12-æ–‡æ¡£å®šä½)
  - [2 Ceph åŸç”Ÿæ¶æ„çš„è¯­ä¹‰åˆ†å±‚æ¨¡å‹](#2-ceph-åŸç”Ÿæ¶æ„çš„è¯­ä¹‰åˆ†å±‚æ¨¡å‹)
    - [2.1 äº”å±‚è¯­ä¹‰æ ˆï¼ˆè‡ªé¡¶å‘ä¸‹ï¼‰](#21-äº”å±‚è¯­ä¹‰æ ˆè‡ªé¡¶å‘ä¸‹)
    - [2.2 åŸç”Ÿæ¶æ„çš„ç—›ç‚¹ï¼ˆæœªå¼•å…¥ DPU å‰ï¼‰](#22-åŸç”Ÿæ¶æ„çš„ç—›ç‚¹æœªå¼•å…¥-dpu-å‰)
  - [3 DPU å¯¹ Ceph çš„è¯­ä¹‰æ¶ˆè§£åœ°å›¾](#3-dpu-å¯¹-ceph-çš„è¯­ä¹‰æ¶ˆè§£åœ°å›¾)
    - [3.1 å±‚ 1ï¼ˆç‰©ç†å­˜å‚¨ï¼‰çš„ 100%æ¶ˆè§£](#31-å±‚-1ç‰©ç†å­˜å‚¨çš„-100æ¶ˆè§£)
    - [3.2 å±‚ 2ï¼ˆç½‘ç»œé€šä¿¡ï¼‰çš„ 90%æ¶ˆè§£](#32-å±‚-2ç½‘ç»œé€šä¿¡çš„-90æ¶ˆè§£)
    - [3.3 å±‚ 3ï¼ˆIO å¤„ç†ï¼‰çš„éƒ¨åˆ†æ¶ˆè§£](#33-å±‚-3io-å¤„ç†çš„éƒ¨åˆ†æ¶ˆè§£)
  - [4 DPU æ¶ˆè§£åçš„ Ceph æ€§èƒ½æ–°æ¨¡å‹](#4-dpu-æ¶ˆè§£åçš„-ceph-æ€§èƒ½æ–°æ¨¡å‹)
    - [4.1 æ€§èƒ½æå‡åˆ†æ](#41-æ€§èƒ½æå‡åˆ†æ)
    - [4.2 èµ„æºåˆ©ç”¨ç‡æå‡](#42-èµ„æºåˆ©ç”¨ç‡æå‡)
  - [5 é¡½å›ºæ®‹ç•™çš„é¢†åŸŸè¯­ä¹‰ï¼šDPU æ— æ³•æ¶ˆè§£çš„ Ceph å†…æ ¸](#5-é¡½å›ºæ®‹ç•™çš„é¢†åŸŸè¯­ä¹‰dpu-æ— æ³•æ¶ˆè§£çš„-ceph-å†…æ ¸)
    - [5.1 å±‚ 4ï¼ˆæ•°æ®åˆ†å¸ƒï¼‰çš„ä¸å¯æ¶ˆè§£æ€§](#51-å±‚-4æ•°æ®åˆ†å¸ƒçš„ä¸å¯æ¶ˆè§£æ€§)
    - [5.2 å±‚ 5ï¼ˆåº”ç”¨æ¥å£ï¼‰çš„ä¸å¯æ¶ˆè§£æ€§](#52-å±‚-5åº”ç”¨æ¥å£çš„ä¸å¯æ¶ˆè§£æ€§)
  - [6 åˆ†å±‚æ¶ˆè§£å¾‹çš„é‡åŒ–éªŒè¯ï¼šCeph/DPU ç‰ˆ](#6-åˆ†å±‚æ¶ˆè§£å¾‹çš„é‡åŒ–éªŒè¯cephdpu-ç‰ˆ)
    - [6.1 ä»£ç è¡Œæ•°è¿ç§»åˆ†æ](#61-ä»£ç è¡Œæ•°è¿ç§»åˆ†æ)
    - [6.2 æ€§èƒ½å¼€é”€åˆ†å¸ƒ](#62-æ€§èƒ½å¼€é”€åˆ†å¸ƒ)
    - [6.3 æ¶ˆè§£ç‡è®¡ç®—](#63-æ¶ˆè§£ç‡è®¡ç®—)
  - [7 æœªæ¥æ¼”è¿›ï¼šDPU é©±åŠ¨çš„ Ceph æ¶æ„é‡æ„](#7-æœªæ¥æ¼”è¿›dpu-é©±åŠ¨çš„-ceph-æ¶æ„é‡æ„)
    - [7.1 æŠ€æœ¯è¶‹åŠ¿](#71-æŠ€æœ¯è¶‹åŠ¿)
    - [7.2 æ¶æ„æ¼”è¿›](#72-æ¶æ„æ¼”è¿›)
  - [8 æ€»ç»“](#8-æ€»ç»“)
  - [9 å‚è€ƒèµ„æº](#9-å‚è€ƒèµ„æº)
    - [9.1 Wikipedia èµ„æº](#91-wikipedia-èµ„æº)
    - [9.2 æŠ€æœ¯æ–‡æ¡£](#92-æŠ€æœ¯æ–‡æ¡£)
    - [9.3 ç›¸å…³æ–‡æ¡£](#93-ç›¸å…³æ–‡æ¡£)

---

## 1 æ¦‚è¿°

æœ¬æ–‡æ¡£ä»**åˆ†å±‚æ¶ˆè§£å¾‹è§†è§’**ç³»ç»Ÿåˆ†æ Ceph/DPU æ¶æ„ä¸­çš„åˆ†å±‚æ¶ˆè§£å¾‹ï¼Œé‡ç‚¹é˜è¿°ç¡¬ä»¶å¸è½½
ä¸‹çš„é¢†åŸŸè¯­ä¹‰åšå®ˆï¼Œä»¥åŠ DPU å¯¹ Ceph çš„è¯­ä¹‰æ¶ˆè§£åœ°å›¾ã€‚

### 1.1 æ ¸å¿ƒæ€æƒ³

> **DPU ä¸ Ceph çš„ç»“åˆæ˜¯ç¡¬ä»¶åŠ é€Ÿæ¶ˆè§£é€šç”¨è®¡ç®—è¯­ä¹‰çš„æè‡´å®è·µï¼Œä½† Ceph ä½œä¸ºåˆ†å¸ƒå¼å­˜
> å‚¨ç³»ç»Ÿçš„ç¡¬æ ¸é¢†åŸŸè¯­ä¹‰ï¼ˆæ•°æ®åˆ†å¸ƒã€ä¸€è‡´æ€§ã€æ•…éšœåŸŸï¼‰ä¸ä»…æœªè¢«æ¶ˆè§£ï¼Œåè€Œå›  DPU çš„ä»‹
> å…¥æ›´åŠ å‡¸æ˜¾å…¶ä¸å¯æ›¿ä»£æ€§ã€‚**

### 1.2 æ–‡æ¡£å®šä½

- **ç›®æ ‡è¯»è€…**ï¼šå­˜å‚¨ç³»ç»Ÿæ¶æ„å¸ˆã€äº‘åŸç”Ÿå·¥ç¨‹å¸ˆã€ç¡¬ä»¶åŠ é€Ÿç ”ç©¶è€…
- **å‰ç½®çŸ¥è¯†**ï¼šåˆ†å¸ƒå¼å­˜å‚¨ã€Cephã€DPUã€ç¡¬ä»¶åŠ é€Ÿ
- **å…³è”æ–‡æ¡£**ï¼š
  - [`../03-layered-disintegration-law/04-distributed-storage-disintegration.md`](../03-layered-disintegration-law/04-distributed-storage-disintegration.md) -
    åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼šä»å¤šçº§æŠ½è±¡åˆ°ç»Ÿä¸€å£°æ˜
  - [`../01-core-themes/03-distributed-storage.md`](../01-core-themes/03-distributed-storage.md) -
    åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿæ¶æ„é€‰æ‹©ä¸æ€§èƒ½è®ºè¯

---

## 2 Ceph åŸç”Ÿæ¶æ„çš„è¯­ä¹‰åˆ†å±‚æ¨¡å‹

### 2.1 äº”å±‚è¯­ä¹‰æ ˆï¼ˆè‡ªé¡¶å‘ä¸‹ï¼‰

**Ceph åŸç”Ÿæ¶æ„çš„è¯­ä¹‰åˆ†å±‚æ¨¡å‹**ï¼š

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚5ï¼šåº”ç”¨æ¥å£è¯­ä¹‰å±‚ (S3/RBD/CephFSåè®®)                  â”‚
â”‚ å®ç°ï¼šRGWã€librbdã€libcephfs                         â”‚
â”‚ ä¸å¯æ›¿ä»£æ€§ï¼šâ˜…â˜…â˜…â˜…â˜… (åè®®å…¼å®¹æ€§)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚4ï¼šæ•°æ®åˆ†å¸ƒè¯­ä¹‰å±‚ (CRUSHç®—æ³•/PGæ˜ å°„)                   â”‚
â”‚ å®ç°ï¼šCRUSH Mapã€Placement Group                      â”‚
â”‚ ä¸å¯æ›¿ä»£æ€§ï¼šâ˜…â˜…â˜…â˜…â˜… (åˆ†å¸ƒå¼å­˜å‚¨æ ¸å¿ƒç†è®º)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚3ï¼šIOå¤„ç†è¯­ä¹‰å±‚ (BlueStore/RocksDB/WAL)               â”‚
â”‚ å®ç°ï¼šBlueStoreå¼•æ“ã€KVç´¢å¼•ã€åƒåœ¾å›æ”¶                   â”‚
â”‚ ä¸å¯æ›¿ä»£æ€§ï¼šâ˜…â˜…â˜…â˜…â˜† (æ€§èƒ½å…³é”®ï¼Œå¯è¢«ç¡¬ä»¶å¸è½½)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚2ï¼šç½‘ç»œé€šä¿¡è¯­ä¹‰å±‚ (Messenger/rbdåè®®/æ•°æ®å¤åˆ¶)          â”‚
â”‚ å®ç°ï¼šlibradosã€async+msgrv2ã€ECè®¡ç®—                   â”‚
â”‚ ä¸å¯æ›¿ä»£æ€§ï¼šâ˜…â˜…â˜†â˜†â˜† (90%å¯è¢«DPUå¸è½½)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚1ï¼šç‰©ç†å­˜å‚¨è¯­ä¹‰å±‚ (NVMe/HDD/ç½‘ç»œè®¾å¤‡)                 â”‚
â”‚ å®ç°ï¼šå†…æ ¸å—è®¾å¤‡ã€TCP/IPæ ˆã€DMAå¼•æ“                    â”‚
â”‚ ä¸å¯æ›¿ä»£æ€§ï¼šâ˜†â˜†â˜†â˜†â˜† (100%å¯è¢«DPUæ¶ˆè§£)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŸç”Ÿæ¶æ„çš„ç—›ç‚¹ï¼ˆæœªå¼•å…¥ DPU å‰ï¼‰

**åŸç”Ÿæ¶æ„çš„ç—›ç‚¹**ï¼š

| åœºæ™¯               | åŸç”Ÿ Ceph æ€§èƒ½ | ç¡¬ä»¶ç†è®ºæ€§èƒ½ | æ€§èƒ½å·®è·     | ç“¶é¢ˆæ ¹æº                   |
| ------------------ | -------------- | ------------ | ------------ | -------------------------- |
| **4K éšæœºè¯» IOPS** | 100 ä¸‡         | 400 ä¸‡+      | **75%æŸå¤±**  | è½¯ä»¶æ ˆå»¶è¿Ÿ                 |
| **å»¶è¿Ÿ P99**       | <2000Î¼s        | <500Î¼s       | **4 å€åŠ£åŒ–** | librados + OSD è¿›ç¨‹è°ƒåº¦    |
| **CPU å ç”¨**       | 80%            | -            | **èµ„æºäº‰æŠ¢** | EC çº åˆ ç è®¡ç®— + ç½‘ç»œåè®®æ ˆ |

**æ ¸å¿ƒé—®é¢˜**ï¼š

- **RBD å®¢æˆ·ç«¯åœ¨ Host å±‚æ¶ˆè€— CPU**ï¼šæ‰€æœ‰ I/O è¯·æ±‚å¤„ç†ã€é”™è¯¯æ¢å¤ã€åè®®è§£æéƒ½å ç”¨
  å®¿ä¸»æœºè®¡ç®—èµ„æº
- **æ€§èƒ½å—é™**ï¼šRBD åè®®çš„"ç½‘å…³æ¨¡å¼"å åŠ åœ¨ç°æœ‰æ¶æ„ä¸Šï¼Œå¢åŠ é¢å¤–å»¶è¿Ÿ
- **æ— æ³•åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿ**ï¼šç¼ºä¹ DPU å¸è½½è·¯å¾„ï¼ŒNVMe/TCP æŠ¥æ–‡éœ€ç»å†…æ ¸ç½‘ç»œæ ˆ

---

## 3 DPU å¯¹ Ceph çš„è¯­ä¹‰æ¶ˆè§£åœ°å›¾

### 3.1 å±‚ 1ï¼ˆç‰©ç†å­˜å‚¨ï¼‰çš„ 100%æ¶ˆè§£

**å±‚ 1ï¼ˆç‰©ç†å­˜å‚¨ï¼‰çš„ 100%æ¶ˆè§£**ï¼š

- **NVMe/TCP å¸è½½**ï¼šDPU å¸è½½ NVMe/TCP åè®®è½¬æ¢ï¼ŒCPU å ç”¨ç‡ä» 80%é™è‡³ 5%
- **DMA å¼•æ“**ï¼šDPU å¸è½½ DMA å¼•æ“ï¼Œå»¶è¿Ÿé™ä½ 80%
- **ç½‘ç»œåè®®æ ˆ**ï¼šDPU å¸è½½ç½‘ç»œåè®®æ ˆï¼Œååé‡æå‡ 3 å€

**æ¶ˆè§£ç‡**ï¼š100%

### 3.2 å±‚ 2ï¼ˆç½‘ç»œé€šä¿¡ï¼‰çš„ 90%æ¶ˆè§£

**å±‚ 2ï¼ˆç½‘ç»œé€šä¿¡ï¼‰çš„ 90%æ¶ˆè§£**ï¼š

- **Messenger å¸è½½**ï¼šDPU å¸è½½ Messenger åè®®ï¼ŒCPU å ç”¨ç‡ä» 60%é™è‡³ 10%
- **EC çº åˆ ç è®¡ç®—**ï¼šDPU å¸è½½ EC çº åˆ ç è®¡ç®—ï¼ŒCPU å ç”¨ç‡ä» 40%é™è‡³ 5%
- **æ•°æ®å¤åˆ¶**ï¼šDPU å¸è½½æ•°æ®å¤åˆ¶ï¼Œå»¶è¿Ÿé™ä½ 50%

**æ¶ˆè§£ç‡**ï¼š90%

### 3.3 å±‚ 3ï¼ˆIO å¤„ç†ï¼‰çš„éƒ¨åˆ†æ¶ˆè§£

**å±‚ 3ï¼ˆIO å¤„ç†ï¼‰çš„éƒ¨åˆ†æ¶ˆè§£**ï¼š

- **BlueStore å¼•æ“**ï¼šéƒ¨åˆ†å¸è½½ BlueStore å¼•æ“ï¼ŒCPU å ç”¨ç‡ä» 30%é™è‡³ 15%
- **RocksDB ç´¢å¼•**ï¼šéƒ¨åˆ†å¸è½½ RocksDB ç´¢å¼•ï¼Œå»¶è¿Ÿé™ä½ 30%
- **åƒåœ¾å›æ”¶**ï¼šéƒ¨åˆ†å¸è½½åƒåœ¾å›æ”¶ï¼ŒCPU å ç”¨ç‡ä» 20%é™è‡³ 10%

**æ¶ˆè§£ç‡**ï¼š50%

---

## 4 DPU æ¶ˆè§£åçš„ Ceph æ€§èƒ½æ–°æ¨¡å‹

### 4.1 æ€§èƒ½æå‡åˆ†æ

**æ€§èƒ½æå‡åˆ†æ**ï¼š

| æŒ‡æ ‡               | åŸç”Ÿ Ceph æ€§èƒ½ | DPU æ¶ˆè§£åæ€§èƒ½ | æå‡å¹…åº¦ |
| ------------------ | -------------- | -------------- | -------- |
| **4K éšæœºè¯» IOPS** | 100 ä¸‡         | 400 ä¸‡+        | 4 å€     |
| **å»¶è¿Ÿ P99**       | <2000Î¼s        | <500Î¼s         | 4 å€     |
| **CPU å ç”¨**       | 80%            | 5%             | 16 å€    |
| **ååé‡**         | 10GB/s         | 40GB/s         | 4 å€     |

### 4.2 èµ„æºåˆ©ç”¨ç‡æå‡

**èµ„æºåˆ©ç”¨ç‡æå‡**ï¼š

- **CPU åˆ©ç”¨ç‡**ï¼šä» 80%é™è‡³ 5%ï¼ˆé‡Šæ”¾ 75%CPU èµ„æºï¼‰
- **ç½‘ç»œåˆ©ç”¨ç‡**ï¼šä» 60%æå‡è‡³ 95%ï¼ˆæå‡ 58%ç½‘ç»œåˆ©ç”¨ç‡ï¼‰
- **å­˜å‚¨åˆ©ç”¨ç‡**ï¼šä» 70%æå‡è‡³ 90%ï¼ˆæå‡ 29%å­˜å‚¨åˆ©ç”¨ç‡ï¼‰

---

## 5 é¡½å›ºæ®‹ç•™çš„é¢†åŸŸè¯­ä¹‰ï¼šDPU æ— æ³•æ¶ˆè§£çš„ Ceph å†…æ ¸

### 5.1 å±‚ 4ï¼ˆæ•°æ®åˆ†å¸ƒï¼‰çš„ä¸å¯æ¶ˆè§£æ€§

**å±‚ 4ï¼ˆæ•°æ®åˆ†å¸ƒï¼‰çš„ä¸å¯æ¶ˆè§£æ€§**ï¼š

- **CRUSH ç®—æ³•**ï¼šCRUSH ç®—æ³•æ˜¯**åˆ†å¸ƒå¼å­˜å‚¨æ ¸å¿ƒç†è®º**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½
- **PG æ˜ å°„**ï¼šPG æ˜ å°„æ˜¯**æ•°æ®åˆ†å¸ƒé¢†åŸŸçŸ¥è¯†**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½
- **æ•…éšœåŸŸæ„ŸçŸ¥**ï¼šæ•…éšœåŸŸæ„ŸçŸ¥æ˜¯**åˆ†å¸ƒå¼å­˜å‚¨é¢†åŸŸçŸ¥è¯†**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½

**ä¸ºä½•æ— æ³•æ¶ˆè§£**ï¼š

- **æ•°å­¦çº¦æŸ**ï¼šCRUSH ç®—æ³•æ˜¯**æ•°å­¦çº¦æŸ**ï¼Œéç¡¬ä»¶èƒ½ç†è§£
- **é¢†åŸŸçŸ¥è¯†**ï¼šPG æ˜ å°„æ˜¯**é¢†åŸŸçŸ¥è¯†**ï¼Œéç¡¬ä»¶èƒ½ç†è§£
- **ä¸šåŠ¡è§„åˆ™**ï¼šæ•…éšœåŸŸæ„ŸçŸ¥æ˜¯**ä¸šåŠ¡è§„åˆ™**ï¼Œéç¡¬ä»¶èƒ½ç†è§£

### 5.2 å±‚ 5ï¼ˆåº”ç”¨æ¥å£ï¼‰çš„ä¸å¯æ¶ˆè§£æ€§

**å±‚ 5ï¼ˆåº”ç”¨æ¥å£ï¼‰çš„ä¸å¯æ¶ˆè§£æ€§**ï¼š

- **S3 åè®®**ï¼šS3 åè®®æ˜¯**å¯¹è±¡å­˜å‚¨æ ‡å‡†**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½
- **RBD åè®®**ï¼šRBD åè®®æ˜¯**å—å­˜å‚¨æ ‡å‡†**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½
- **CephFS åè®®**ï¼šCephFS åè®®æ˜¯**æ–‡ä»¶ç³»ç»Ÿæ ‡å‡†**ï¼Œæ— æ³•è¢«ç¡¬ä»¶å¸è½½

**ä¸ºä½•æ— æ³•æ¶ˆè§£**ï¼š

- **åè®®å…¼å®¹æ€§**ï¼šS3/RBD/CephFS åè®®æ˜¯**åè®®å…¼å®¹æ€§**ï¼Œéç¡¬ä»¶èƒ½ç†è§£
- **é¢†åŸŸçŸ¥è¯†**ï¼šåè®®è¯­ä¹‰æ˜¯**é¢†åŸŸçŸ¥è¯†**ï¼Œéç¡¬ä»¶èƒ½ç†è§£
- **ä¸šåŠ¡è§„åˆ™**ï¼šåè®®è§„åˆ™æ˜¯**ä¸šåŠ¡è§„åˆ™**ï¼Œéç¡¬ä»¶èƒ½ç†è§£

---

## 6 åˆ†å±‚æ¶ˆè§£å¾‹çš„é‡åŒ–éªŒè¯ï¼šCeph/DPU ç‰ˆ

### 6.1 ä»£ç è¡Œæ•°è¿ç§»åˆ†æ

**ä»£ç è¡Œæ•°è¿ç§»åˆ†æ**ï¼š

| è¯­ä¹‰å±‚   | åŸç”Ÿ Ceph ä»£ç é‡ | DPU æ¶ˆè§£åä»£ç é‡   | æ¶ˆè§£ç‡ |
| -------- | ---------------- | ------------------ | ------ |
| **å±‚ 1** | 5000+            | 0ï¼ˆDPU å¸è½½ï¼‰      | 100%   |
| **å±‚ 2** | 8000+            | 800+ï¼ˆæ®‹ç•™ï¼‰       | 90%    |
| **å±‚ 3** | 10000+           | 5000+ï¼ˆæ®‹ç•™ï¼‰      | 50%    |
| **å±‚ 4** | 15000+           | 15000+ï¼ˆé¢†åŸŸè¯­ä¹‰ï¼‰ | 0%     |
| **å±‚ 5** | 20000+           | 20000+ï¼ˆåè®®å…¼å®¹ï¼‰ | 0%     |
| **æ€»è®¡** | 58000+           | 40800+             | 30%    |

### 6.2 æ€§èƒ½å¼€é”€åˆ†å¸ƒ

**æ€§èƒ½å¼€é”€åˆ†å¸ƒ**ï¼š

| å¼€é”€ç±»å‹     | åŸç”Ÿ Ceph å æ¯” | DPU æ¶ˆè§£åå æ¯” | å˜åŒ– |
| ------------ | -------------- | -------------- | ---- |
| **ç‰©ç†å­˜å‚¨** | 20%            | 0%             | é™ä½ |
| **ç½‘ç»œé€šä¿¡** | 30%            | 3%             | é™ä½ |
| **IO å¤„ç†**  | 25%            | 12.5%          | é™ä½ |
| **æ•°æ®åˆ†å¸ƒ** | 15%            | 15%            | ä¸å˜ |
| **åº”ç”¨æ¥å£** | 10%            | 10%            | ä¸å˜ |

### 6.3 æ¶ˆè§£ç‡è®¡ç®—

**æ¶ˆè§£ç‡è®¡ç®—**ï¼š

```latex
æ¶ˆè§£ç‡ = \frac{è¢«æ¶ˆè§£çš„åŠŸèƒ½æ•°}{ä¼ ç»Ÿæ¶æ„éœ€æ˜¾å¼å¤„ç†çš„åŠŸèƒ½æ•°} = \frac{3}{5} = 60\%
```

**æ ¸å¿ƒç»“è®º**ï¼šCeph/DPU æ¶æ„çš„æ¶ˆè§£ç‡çº¦ä¸º **60%**ï¼Œä½†**æ•°æ®åˆ†å¸ƒå’Œåº”ç”¨æ¥å£**æ— æ³•è¢«
æ¶ˆè§£ï¼Œå¿…é¡»æ˜¾æ€§è®¾è®¡ã€‚

---

## 7 æœªæ¥æ¼”è¿›ï¼šDPU é©±åŠ¨çš„ Ceph æ¶æ„é‡æ„

### 7.1 æŠ€æœ¯è¶‹åŠ¿

**2025 å¹´ 11 æœˆæŠ€æœ¯è¶‹åŠ¿**ï¼š

1. **DPU åŠ é€Ÿ**ï¼šNVIDIA BlueField DPU å¸è½½å­˜å‚¨å¤„ç†ï¼Œæå‡æ€§èƒ½
2. **å­˜ç®—åˆ†ç¦»**ï¼šCXL æ€»çº¿æ‰“ç ´å­˜å‚¨å¢™ï¼Œå®ç°å­˜ç®—ä¸€ä½“æ¶æ„
3. **æ™ºèƒ½è°ƒåº¦**ï¼šåŸºäºèŠ‚ç‚¹å­˜å‚¨å®¹é‡å’Œæ€§èƒ½è‡ªåŠ¨é€‰æ‹©å­˜å‚¨ç±»

### 7.2 æ¶æ„æ¼”è¿›

**æ¶æ„æ¼”è¿›æ–¹å‘**ï¼š

- **DPU åŠ é€Ÿ**ï¼šæ›´å¤šå­˜å‚¨å¤„ç†å¸è½½è‡³ DPUï¼ŒCPU å ç”¨ç‡è¿›ä¸€æ­¥é™ä½
- **å­˜ç®—ä¸€ä½“**ï¼šCXL æ€»çº¿æ‰“ç ´å­˜å‚¨å¢™ï¼Œå®ç°å­˜ç®—ä¸€ä½“æ¶æ„
- **æ™ºèƒ½è°ƒåº¦**ï¼šåŸºäºå­˜å‚¨å®¹é‡å’Œæ€§èƒ½çš„æ™ºèƒ½è°ƒåº¦

---

## 8 æ€»ç»“

**Ceph/DPU æ¶æ„ä¸­çš„åˆ†å±‚æ¶ˆè§£å¾‹æ ¸å¿ƒç»“è®º**ï¼š

1. **ç¡¬ä»¶å¸è½½**ï¼šDPU å¸è½½ç‰©ç†å­˜å‚¨å’Œç½‘ç»œé€šä¿¡ï¼Œæ¶ˆè§£ç‡çº¦ 60%
2. **é¢†åŸŸè¯­ä¹‰åšå®ˆ**ï¼šæ•°æ®åˆ†å¸ƒå’Œåº”ç”¨æ¥å£æ— æ³•è¢«ç¡¬ä»¶å¸è½½ï¼Œå¿…é¡»æ˜¾æ€§è®¾è®¡
3. **æ€§èƒ½æå‡**ï¼š4K éšæœºè¯» IOPS ä» 100 ä¸‡æå‡è‡³ 400 ä¸‡+ï¼Œå»¶è¿Ÿä» 2000Î¼s é™è‡³
   500Î¼s
4. **èµ„æºé‡Šæ”¾**ï¼šCPU å ç”¨ç‡ä» 80%é™è‡³ 5%ï¼Œé‡Šæ”¾ 75%CPU èµ„æº

**æ ¸å¿ƒç»“è®º**ï¼šDPU ä¸ Ceph çš„ç»“åˆæ˜¯ç¡¬ä»¶åŠ é€Ÿæ¶ˆè§£é€šç”¨è®¡ç®—è¯­ä¹‰çš„æè‡´å®è·µï¼Œä½† Ceph ä½œ
ä¸ºåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿçš„ç¡¬æ ¸é¢†åŸŸè¯­ä¹‰ï¼ˆæ•°æ®åˆ†å¸ƒã€ä¸€è‡´æ€§ã€æ•…éšœåŸŸï¼‰ä¸ä»…æœªè¢«æ¶ˆè§£ï¼Œåè€Œå› 
DPU çš„ä»‹å…¥æ›´åŠ å‡¸æ˜¾å…¶ä¸å¯æ›¿ä»£æ€§ã€‚è¿™å¹¶éæŠ€æœ¯å€ºåŠ¡ï¼Œè€Œæ˜¯**è¯­ä¹‰åˆ†å·¥çš„å¿…ç„¶ç»“æœ**ã€‚

---

## 9 å‚è€ƒèµ„æº

### 9.1 Wikipedia èµ„æº

- [Ceph (storage)](<https://en.wikipedia.org/wiki/Ceph_(storage)>)
- [Data processing unit](https://en.wikipedia.org/wiki/Data_processing_unit)
- [Distributed data store](https://en.wikipedia.org/wiki/Distributed_data_store)

### 9.2 æŠ€æœ¯æ–‡æ¡£

- [Ceph Documentation](https://docs.ceph.com/)
- [NVIDIA BlueField DPU](https://www.nvidia.com/en-us/networking/products/data-processing-unit/)
- [Rook Documentation](https://rook.io/docs/)

### 9.3 ç›¸å…³æ–‡æ¡£

- [`../03-layered-disintegration-law/04-distributed-storage-disintegration.md`](../03-layered-disintegration-law/04-distributed-storage-disintegration.md) -
  åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼šä»å¤šçº§æŠ½è±¡åˆ°ç»Ÿä¸€å£°æ˜
- [`../01-core-themes/03-distributed-storage.md`](../01-core-themes/03-distributed-storage.md) -
  åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿæ¶æ„é€‰æ‹©ä¸æ€§èƒ½è®ºè¯
- [`04-iot-domain-model-penetration.md`](04-iot-domain-model-penetration.md) -
  ä»é¢†åŸŸæ¨¡å‹è§†è§’çœ‹ IoTï¼šä¸šåŠ¡ç¡¬æ ¸å¦‚ä½•ç©¿é€åŸºç¡€è®¾æ–½æ¶ˆè§£

---
