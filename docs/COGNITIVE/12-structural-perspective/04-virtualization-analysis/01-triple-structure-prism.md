# 12.4.1 结构主义三棱镜分析

## 📑 目录

- [📑 目录](#-目录)
- [12.4.1.1 三件套的最小定义](#12411-三件套的最小定义)
  - [核心思想](#核心思想)
  - [最小定义](#最小定义)
- [12.4.1.2 结构主义三棱镜](#12412-结构主义三棱镜)
  - [三维结构对比表](#三维结构对比表)
  - [一句话总结](#一句话总结)
- [12.4.1.3 结构三角形](#12413-结构三角形)
  - [可视化表示](#可视化表示)
  - [位置分析](#位置分析)
- [12.4.1.4 小结口诀](#12414-小结口诀)
- [12.4.1.5 参考](#12415-参考)
  - [相关文档](#相关文档)

---

## 12.4.1.1 三件套的最小定义

### 核心思想

把"虚拟化 / 容器化 / 沙盒化"再放进"三元结构"天平称一次，你会发现它们其实**共用同
一套机制**，只是**在三大结构上的取舍比例不同**。

### 最小定义

| 概念                    | 一句话定义                                          | 核心目的                                     |
| ----------------------- | --------------------------------------------------- | -------------------------------------------- |
| 虚拟化 Virtualization   | 把**硬件指令集+资源**做成**可多路复用的抽象**       | 让多台"机器"互不感知地跑在同一物理机上       |
| 容器化 Containerization | 把**操作系统调用+命名空间**做成**可多路复用的抽象** | 让多组进程以为自己独占整个 Linux             |
| 沙盒化 Sandboxing       | 把**权限+可见性**做成**可受限的抽象**               | 让同一把用户态二进制跑在**最小可行上下文**里 |

---

## 12.4.1.2 结构主义三棱镜

### 三维结构对比表

| 结构维度                        | 虚拟化                                                                                                                                 | 容器化                                                                                                                                                                | 沙盒化                                                                                                                                         |
| ------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| **计算结构**<br>(Computational) | • 指令集级**完全封闭**<br>• 客户机指令被**动态二进制翻译**或硬件捕获<br>• 状态=寄存器+内存+设备，**可快照**                            | • 系统调用级**半封闭**<br>• 进程继续发**原生指令**，只有**syscall 被重定向**<br>• 状态 ≈ cgroup+namespace+rootfs，**可镜像**                                          | • **用户态指令零修改**<br>• 仅把**危险 syscall 子集**过滤/仿真<br>• 状态 ≈ 过滤表+文件系统视图，**轻量**                                       |
| **控制结构**<br>(Control)       | • **强序保证**：VM-Exit/Entry 形成**全局同步点**<br>• 客户机内部再并发，**Host 可透明抢占**<br>• 迁移=**停机-拷贝-恢复**，序被**冻结** | • **弱序**：namespace 隔离**PID/IPC/Net** 名字空间，**但时钟一致**<br>• cgroup 仅做**统计与冻结**，不重塑序<br>• 镜像层**只读共享**，写时复制**序局部化**             | • **最小序干预**：<br> – seccomp-bpf：**系统调用偏序过滤**<br> – pledge/unveil：**能力降序**<br>• 通常**不迁移**，序无需全局冻结               |
| **信息结构**<br>(Information)   | • **完全信息伪装**：ACPI 表/PCI 拓扑/CPUID 皆可**伪造**<br>• 内存与磁盘**字节级隔离**<br>• 代价：**冗余内核+镜像**                     | • **部分信息伪装**：<br> – `/proc`、`/sys` 视图被**重新挂载**<br> – 但**内核版本相同**，**系统调用语义一致**<br>• 镜像分层=**信息拓扑的"近似"**：只读层+写层=**开集** | • **最小信息欺骗**：<br> – 仅**文件系统 chroot/namespace**<br> – 返回**ENOENT** 而不是**伪造内容**<br>• 错误码**保持原有语义**，**不扭曲拓扑** |

### 一句话总结

**虚拟化"重计算"、容器化"折中"、沙盒化"轻信息"**。

---

## 12.4.1.3 结构三角形

### 可视化表示

把三条技术摆在**等边三角形**顶点，越靠近某顶点表示**在该结构上投入最重**：

```text
                   计算结构
                      ^
                      |  虚拟化
                      |
                      |
   沙盒化 <-----------+-----------> 容器化
   (信息结构)         |         (控制+计算折中)
                      |
                      |
                   控制结构
```

### 位置分析

- **虚拟化**几乎垂直拉高"计算结构"轴：

  - 硬件级状态机完整克隆
  - 控制与信息可伪装，但**首要保证计算语义一致**

- **容器化**落在**计算-控制边缘**：

  - 仍需 syscall 级**重定向**（控制）
  - 但不需要指令级仿真（计算轻一半）

- **沙盒化**紧贴**信息结构**角：
  - 计算零修改，控制只加**过滤点**
  - 核心在**最小可见性/最小权限**——**信息拓扑的"开覆盖"最小化**

---

## 12.4.1.4 小结口诀

```text
虚拟化：重计算，全局序，信息全造假；
容器化： syscall 换名字，镜像分层像拓扑；
沙盒化：不动计算，只剪权限，最小邻近集。
```

用这三根杠杆去量任何"隔离/安全/密度"需求，你很快就能说出： **"到底是要一个新宇宙
，还是只要一道栅栏。"**

---

## 12.4.1.5 参考

### 相关文档

- **[复合技术分析](02-composite-technologies.md)** -
  KVM+QEMU、gVisor、Firecracker、WASM 等复合技术
- **[选型原则](03-selection-principles.md)** - 结构主义选型格言和原则
- **[三类结构分析](../02-three-structures/README.md)** - 计算结构、控制结构、信
  息结构的深入分析
- **[源文档](../../../structure_view.md)** - 结构视角的完整论述

---

**更新时间**：2025-11-05 **版本**：v1.0
