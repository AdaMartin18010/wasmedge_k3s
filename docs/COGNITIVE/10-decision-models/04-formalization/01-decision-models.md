# 01. 决策模型形式化

## 目录

- [目录](#目录)
- [01.1 概述](#011-概述)
- [01.2 决策模型数学表达](#012-决策模型数学表达)
  - [01.2.1 决策问题定义](#0121-决策问题定义)
  - [01.2.2 决策函数](#0122-决策函数)
  - [01.2.3 决策空间](#0123-决策空间)
- [01.3 权衡函数](#013-权衡函数)
  - [01.3.1 多维度权衡函数](#0131-多维度权衡函数)
  - [01.3.2 维度定义](#0132-维度定义)
    - [性能维度 $f\_1$](#性能维度-f_1)
    - [资源维度 $f\_2$](#资源维度-f_2)
  - [01.3.3 权重设置](#0133-权重设置)
- [01.4 场景-技术映射模型](#014-场景-技术映射模型)
  - [01.4.1 映射函数定义](#0141-映射函数定义)
  - [01.4.2 场景特征向量](#0142-场景特征向量)
  - [01.4.3 映射决策规则](#0143-映射决策规则)
- [01.5 决策模型实例化](#015-决策模型实例化)
  - [01.5.1 边缘计算场景实例](#0151-边缘计算场景实例)
  - [01.5.2 Serverless 场景实例](#0152-serverless-场景实例)
  - [01.5.3 企业应用场景实例](#0153-企业应用场景实例)
- [01.6 参考](#016-参考)

---

## 01.1 概述

**决策模型形式化**将技术决策过程数学化表达，提供形式化的决策模型和权衡函数，帮助
进行系统化的技术选型。

**核心问题**：

- 如何形式化表达技术决策问题？
- 如何构建多维度权衡函数？
- 如何建立场景-技术映射模型？

---

## 01.2 决策模型数学表达

### 01.2.1 决策问题定义

**决策问题定义**：

设决策问题为 $D = (S, O, C, F)$，其中：

- $S$ = 场景需求集合
- $O$ = 技术选项集合
- $C$ = 约束条件集合
- $F$ = 评估函数

**符号定义**：

- $s \in S$：场景需求
  - $s = (r, l, i, c, \ldots)$：场景特征向量
    - $r$：资源限制级别
    - $l$：延迟要求级别
    - $i$：隔离要求级别
    - $c$：兼容性要求级别
- $o \in O$：技术选项
  - $o \in \{\text{VM}, \text{Container}, \text{Wasm}\}$：虚拟化、容器化、沙盒化
- $C$：约束条件
  - $C = \{c_1, c_2, \ldots, c_n\}$：技术约束、资源约束、运营约束
- $F: S \times O \times C \rightarrow \mathbb{R}$：评估函数
  - $F(s, o, C)$：场景 $s$、选项 $o$、约束 $C$ 的综合评估分数

### 01.2.2 决策函数

**决策函数**：

$$D(s) = \arg\max_{o \in O} F(s, o, C)$$

其中：

- $D(s)$：场景 $s$ 的决策结果（最优技术选项）
- $\arg\max_{o \in O}$：在技术选项集合 $O$ 中选择评估分数最高的选项
- $F(s, o, C)$：综合评估分数

**决策函数性质**：

1. **单调性**：评估分数越高，技术选项越优
2. **可比较性**：不同技术选项可比较
3. **最优性**：选择评估分数最高的选项

### 01.2.3 决策空间

**决策空间定义**：

决策空间 $\mathcal{D} = S \times O$，其中：

- $S$：场景需求空间
- $O$：技术选项空间

**决策空间划分**：

```text
决策空间划分:
├── 资源受限场景 × WasmSandbox → 边缘计算、Serverless
├── 强隔离场景 × Virtualization → 企业应用、金融系统
├── 资源共享场景 × Containerization → 微服务、CI/CD
└── 混合场景 × Hybrid → 多种范式混合
```

---

## 01.3 权衡函数

### 01.3.1 多维度权衡函数

**多维度权衡函数**：

$$F(s, o, C) = \sum_{i=1}^{n} w_i \cdot f_i(s, o, C)$$

其中：

- $w_i$：维度权重（$\sum_{i=1}^{n} w_i = 1$）
- $f_i(s, o, C)$：第 $i$ 个维度的评估分数
- $n$：评估维度数量

**权衡函数性质**：

1. **线性组合**：多维度评分的加权求和
2. **归一化**：权重总和为 1
3. **可扩展性**：可添加新维度

### 01.3.2 维度定义

**评估维度定义**：

| 维度       | 函数符号 | 评估内容           | 取值范围 |
| ---------- | -------- | ------------------ | -------- |
| **性能**   | $f_1$    | 启动速度、运行效率 | $[0, 5]$ |
| **资源**   | $f_2$    | 内存、CPU 占用     | $[0, 5]$ |
| **安全**   | $f_3$    | 隔离强度、攻击面   | $[0, 5]$ |
| **兼容性** | $f_4$    | OS 支持、应用兼容  | $[0, 5]$ |
| **成本**   | $f_5$    | 部署成本、运维成本 | $[0, 5]$ |

**维度评估函数示例**：

#### 性能维度 $f_1$

$$f_1(s, o, C) = w_{1a} \cdot f_{1a}(o) + w_{1b} \cdot f_{1b}(o)$$

其中：

- $f_{1a}(o)$：启动速度评估（启动时间越短分数越高）
- $f_{1b}(o)$：运行效率评估（运行效率越高分数越高）
- $w_{1a} + w_{1b} = 1$

#### 资源维度 $f_2$

$$f_2(s, o, C) = w_{2a} \cdot f_{2a}(o) + w_{2b} \cdot f_{2b}(o)$$

其中：

- $f_{2a}(o)$：内存占用评估（内存占用越少分数越高）
- $f_{2b}(o)$：CPU 占用评估（CPU 占用越少分数越高）
- $w_{2a} + w_{2b} = 1$

### 01.3.3 权重设置

**权重设置模型**：

根据场景特点设置权重 $\mathbf{w} = (w_1, w_2, \ldots, w_n)$，其中：

$$\sum_{i=1}^{n} w_i = 1, \quad w_i \geq 0$$

**权重设置规则**：

1. **资源受限场景**：

   - $\mathbf{w} = (0.2, 0.4, 0.2, 0.1, 0.1)$
   - 资源维度权重最高（0.4）

2. **安全关键场景**：

   - $\mathbf{w} = (0.2, 0.1, 0.4, 0.2, 0.1)$
   - 安全维度权重最高（0.4）

3. **性能关键场景**：
   - $\mathbf{w} = (0.4, 0.3, 0.2, 0.1, 0.0)$
   - 性能维度权重最高（0.4）

**权重数学表达**：

$$w_i = \frac{e^{\alpha_i}}{\sum_{j=1}^{n} e^{\alpha_j}}$$

其中：

- $\alpha_i$：维度 $i$ 的重要性参数
- 使用 softmax 函数确保权重归一化

---

## 01.4 场景-技术映射模型

### 01.4.1 映射函数定义

**映射函数**：

$$M: S \rightarrow O$$

其中：

- $S$：场景特征向量空间
- $O$：技术选项集合

**映射函数性质**：

1. **确定性**：相同场景映射到相同选项
2. **单射性**：不同场景可能映射到不同选项
3. **覆盖性**：覆盖所有场景类型

### 01.4.2 场景特征向量

**场景特征向量**：

$$s = (r, l, i, c, p, \ldots)$$

其中：

- $r$：资源限制级别（受限/中等/充足）
- $l$：延迟要求级别（低延迟/中等延迟/不敏感）
- $i$：隔离要求级别（强隔离/中等隔离/轻量隔离）
- $c$：兼容性要求级别（多 OS/单 OS/应用特定）
- $p$：性能要求级别（高性能/标准性能/低性能）

**特征向量编码**：

- **离散值编码**：受限=0, 中等=1, 充足=2
- **连续值编码**：资源限制比例 [0, 1]
- **混合编码**：离散值 + 连续值

### 01.4.3 映射决策规则

**映射决策规则**：

```text
映射函数 M(s):
  if r == "受限" and l == "低延迟":
      return WasmSandbox
  elif i == "强隔离" and c == "多OS":
      return Virtualization
  elif r == "中等" and i == "中等隔离":
      return Containerization
  else:
      return argmax_{o \in O} F(s, o, C)
```

**映射规则数学表达**：

$$
M(s) = \begin{cases}
\text{WasmSandbox} & \text{if } r = \text{受限} \land l = \text{低延迟} \\
\text{Virtualization} & \text{if } i = \text{强隔离} \land c = \text{多OS} \\
\text{Containerization} & \text{if } r = \text{中等} \land i = \text{中等隔离} \\
\arg\max_{o \in O} F(s, o, C) & \text{otherwise}
\end{cases}
$$

---

## 01.5 决策模型实例化

### 01.5.1 边缘计算场景实例

**场景特征向量**：

$$s_{\text{edge}} = (r=\text{受限}, l=\text{低延迟}, i=\text{轻量隔离}, c=\text{应用特定})$$

**技术选项集合**：

$$O = \{\text{VM}, \text{Container}, \text{Wasm}\}$$

**评估函数**：

$$F(s_{\text{edge}}, o, C) = 0.3 \cdot f_1(o) + 0.3 \cdot f_2(o) + 0.2 \cdot f_3(o) + 0.2 \cdot f_4(o)$$

其中：

- 权重：$\mathbf{w} = (0.3, 0.3, 0.2, 0.2)$（性能和资源优先）

**评估结果**：

| 选项          | $f_1$ | $f_2$ | $f_3$ | $f_4$ | $F(s_{\text{edge}}, o)$ |
| ------------- | ----- | ----- | ----- | ----- | ----------------------- |
| **VM**        | 2     | 2     | 5     | 5     | 3.1                     |
| **Container** | 4     | 3     | 3     | 4     | 3.5                     |
| **Wasm**      | 5     | 5     | 2     | 3     | **4.1** ✅              |

**决策结果**：

$$D(s_{\text{edge}}) = \arg\max_{o \in O} F(s_{\text{edge}}, o, C) = \text{Wasm}$$

### 01.5.2 Serverless 场景实例

**场景特征向量**：

$$s_{\text{serverless}} = (r=\text{受限}, l=\text{低延迟}, i=\text{轻量隔离}, c=\text{应用特定})$$

**评估函数**：

$$F(s_{\text{serverless}}, o, C) = 0.4 \cdot f_1(o) + 0.3 \cdot f_2(o) + 0.2 \cdot f_3(o) + 0.1 \cdot f_4(o)$$

其中：

- 权重：$\mathbf{w} = (0.4, 0.3, 0.2, 0.1)$（性能优先）

**评估结果**：

| 选项          | $f_1$ | $f_2$ | $f_3$ | $f_4$ | $F(s_{\text{serverless}}, o)$ |
| ------------- | ----- | ----- | ----- | ----- | ----------------------------- |
| **VM**        | 2     | 2     | 5     | 5     | 2.7                           |
| **Container** | 4     | 3     | 3     | 4     | 3.7                           |
| **Wasm**      | 5     | 5     | 2     | 3     | **4.6** ✅                    |

**决策结果**：

$$D(s_{\text{serverless}}) = \arg\max_{o \in O} F(s_{\text{serverless}}, o, C) = \text{Wasm}$$

### 01.5.3 企业应用场景实例

**场景特征向量**：

$$s_{\text{enterprise}} = (r=\text{充足}, l=\text{中等延迟}, i=\text{强隔离}, c=\text{多OS})$$

**评估函数**：

$$F(s_{\text{enterprise}}, o, C) = 0.2 \cdot f_1(o) + 0.1 \cdot f_2(o) + 0.4 \cdot f_3(o) + 0.3 \cdot f_4(o)$$

其中：

- 权重：$\mathbf{w} = (0.2, 0.1, 0.4, 0.3)$（安全和兼容性优先）

**评估结果**：

| 选项          | $f_1$ | $f_2$ | $f_3$ | $f_4$ | $F(s_{\text{enterprise}}, o)$ |
| ------------- | ----- | ----- | ----- | ----- | ----------------------------- |
| **VM**        | 2     | 2     | 5     | 5     | **4.8** ✅                    |
| **Container** | 4     | 3     | 3     | 4     | 3.9                           |
| **Wasm**      | 5     | 5     | 2     | 3     | 3.4                           |

**决策结果**：

$$D(s_{\text{enterprise}}) = \arg\max_{o \in O} F(s_{\text{enterprise}}, o, C) = \text{VM}$$

---

## 01.6 参考

**关联文档**：

- **[资源模型形式化](02-resource-models.md)** - 资源模型形式化
- **[技术决策框架](../02-scenario-models/01-decision-framework.md)** - 技术决策
  模型与权衡框架
- **[理论模型](../01-theory-models/)** - 技术范式背后的理论模型
- **[主文档](../decision-models.md)** - 完整技术决策模型文档

**外部参考**：

- [Decision theory](https://en.wikipedia.org/wiki/Decision_theory)
- [Multi-criteria decision analysis](https://en.wikipedia.org/wiki/Multi-criteria_decision_analysis)
- [Mathematical optimization](https://en.wikipedia.org/wiki/Mathematical_optimization)

---

**最后更新**：2025-01-XX **维护者**：项目团队
